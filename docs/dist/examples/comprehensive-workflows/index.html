<!DOCTYPE html><html lang="en" class="light"><head>
    <script type="module">import { injectIntoGlobalHook } from "/tidy-ts/@react-refresh";
injectIntoGlobalHook(window);
window.$RefreshReg$ = () => {};
window.$RefreshSig$ = () => (type) => type;</script>

    <script type="module" src="/tidy-ts/@vite/client"></script>

    <meta charset="UTF-8">
    <link rel="icon" type="image/svg+xml" href="/tidy-ts/favicon.svg" sizes="any">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/tidy-ts/src/index.css" rel="stylesheet">
    <title>Tidy-TS</title>
  <style id="_goober"> .go905199096{direction:ltr;position:fixed;bottom:0;right:0;z-index:99999;width:100%;max-height:90%;border-top:1px solid #344054;transform-origin:top;}.go283257069{cursor:pointer;display:flex;flex-direction:column;background-color:transparent;border:none;font-family:ui-sans-serif, Inter, system-ui, sans-serif, sans-serif;gap:calc(var(--tsrd-font-size) * 0.125);padding:0px;}.go283257069:hover{opacity:0.7;}.go283257069:focus-visible{outline-offset:4px;border-radius:calc(var(--tsrd-font-size) * 0.125);outline:2px solid #1849A9;}.go151905477{font-size:var(--tsrd-font-size);font-weight:700;line-height:calc(var(--tsrd-font-size) * 1);white-space:nowrap;color:#d0d5dd;}.go2259959382{font-weight:600;font-size:calc(var(--tsrd-font-size) * 0.75);background:linear-gradient(to right, #84cc16, #10b981);background-clip:text;-webkit-background-clip:text;line-height:1;-webkit-text-fill-color:transparent;white-space:nowrap;}.go1688509379{display:flex;font-size:calc(var(--tsrd-font-size) * 0.875);font-family:ui-sans-serif, Inter, system-ui, sans-serif, sans-serif;background-color:#191c24;color:#d0d5dd;}@media (max-width: 700px){.go1688509379{flex-direction:column;}}@media (max-width: 600px){.go1688509379{font-size:calc(var(--tsrd-font-size) * 0.75);}}.go1505018836{position:absolute;left:0;top:0;width:100%;height:4px;cursor:row-resize;z-index:100000;}.go1505018836:hover{background-color:#9B8AFBe5;}.go1468579934{flex:1 1 500px;min-height:40%;max-height:100%;overflow:auto;border-right:1px solid #344054;display:flex;flex-direction:column;}.go3747950898{overflow-y:auto;flex:1;}.go2041761433{padding:calc(var(--tsrd-font-size) * 0.5);}.go1648261519{display:flex;align-items:center;padding:calc(var(--tsrd-font-size) * 0.5) calc(var(--tsrd-font-size) * 0.625);gap:calc(var(--tsrd-font-size) * 0.625);border-bottom:#292e3d 1px solid;}.go2273422943{font-family:ui-sans-serif, Inter, system-ui, sans-serif, sans-serif;position:sticky;top:0;z-index:2;background-color:#212530;padding:0px calc(var(--tsrd-font-size) * 0.5);font-weight:500;font-size:calc(var(--tsrd-font-size) * 0.75);min-height:calc(var(--tsrd-font-size) * 2);line-height:calc(var(--tsrd-font-size) * 1);text-align:left;display:flex;align-items:center;}.go728099125{background:#7A2E0Eb3;color:#FEC84B;display:inline-block;padding:0px calc(var(--tsrd-font-size) * 0.625);border-radius:9999px;font-size:calc(var(--tsrd-font-size) * 0.75);font-weight:400;border:1px solid #FEC84B;}.go337815874{color:#FEC84B;}.go3889393570{padding:calc(var(--tsrd-font-size) * 0.375) calc(var(--tsrd-font-size) * 0.5);display:flex;align-items:center;justify-content:space-between;font-size:calc(var(--tsrd-font-size) * 0.75);}.go3620606704{display:flex;align-items:center;border:1px solid #667085;border-radius:calc(var(--tsrd-font-size) * 0.25);overflow:hidden;}.go3993070631{flex:1;justify-content:flex-end;display:flex;align-items:center;font-weight:400;color:#98a2b3;}.go1957354353{flex:1;line-height:calc(var(--tsrd-font-size) * 1);}.go2821925789{flex:1 1 500px;overflow:auto;display:flex;flex-direction:column;height:100%;border-right:1px solid #344054;}@media (max-width: 700px){.go2821925789{border-top:2px solid #344054;}}.go2851609767{flex:1 1 500px;min-height:40%;max-height:100%;overflow:auto;display:flex;flex-direction:column;}.go427126709{overflow-x:auto;overflow-y:visible;}.go28497138{display:'flex';align-items:'center';flex-grow:1;min-width:0;}.go263506863{color:#98a2b3;font-size:calc(var(--tsrd-font-size) * 0.75);line-height:calc(var(--tsrd-font-size) * 1);}.go2308520686{font-size:calc(var(--tsrd-font-size) * 0.75);line-height:calc(var(--tsrd-font-size) * 1);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}.go1560856704{flex:1 1 auto;overflow-y:auto;}.go1860426633{flex:1 1 auto;overflow-y:auto;max-height:50%;}.go2050333436{flex:1;justify-content:flex-end;display:flex;}.go1035001778{display:flex;flex-direction:column;padding:calc(var(--tsrd-font-size) * 0.5);font-size:calc(var(--tsrd-font-size) * 0.75);color:#d0d5dd;line-height:calc(var(--tsrd-font-size) * 1.25);}.go2148009764{display:flex;justify-content:flex-end;flex:1;}.go2225354009{display:flex;}.go1767807125{background:#191c24;padding:calc(var(--tsrd-font-size) * 0.25) calc(var(--tsrd-font-size) * 0.5) calc(var(--tsrd-font-size) * 0.25) calc(var(--tsrd-font-size) * 0.375);border-radius:calc(var(--tsrd-font-size) * 0.375);position:fixed;z-index:99999;display:inline-flex;width:fit-content;cursor:pointer;appearance:none;border:1px solid #667085;gap:8px;align-items:center;font-size:calc(var(--tsrd-font-size) * 0.75);transition:all 0.25s ease-out;}.go1767807125:hover{background:#292e3d;}.go1561890071{font-weight:600;font-size:calc(var(--tsrd-font-size) * 0.75);background:linear-gradient(to right, #98f30c, #00f4a3);background-clip:text;-webkit-background-clip:text;line-height:1;-webkit-text-fill-color:transparent;white-space:nowrap;}.go2821754102{width:1px;background:#475467;height:100%;border-radius:999999px;color:transparent;}.go1460193506{position:relative;width:calc(var(--tsrd-font-size) * 1.25);height:calc(var(--tsrd-font-size) * 1.25);background:pink;border-radius:999999px;overflow:hidden;}.go2552515089{width:calc(var(--tsrd-font-size) * 1.25);height:calc(var(--tsrd-font-size) * 1.25);position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);filter:blur(3px) saturate(1.8) contrast(2);}.go3455555371{width:calc(var(--tsrd-font-size) * 1);height:calc(var(--tsrd-font-size) * 1);position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);}.go2224423957{position:absolute;cursor:pointer;z-index:100001;display:flex;align-items:center;justify-content:center;outline:none;background-color:#191c24;top:0;right:calc(var(--tsrd-font-size) * 0.5);transform:translate(0, -100%);border-right:#394056 1px solid;border-left:#394056 1px solid;border-top:#394056 1px solid;border-bottom:none;border-radius:calc(var(--tsrd-font-size) * 0.25) calc(var(--tsrd-font-size) * 0.25) 0px 0px;padding:calc(var(--tsrd-font-size) * 0.25) calc(var(--tsrd-font-size) * 0.375) calc(var(--tsrd-font-size) * 0.125) calc(var(--tsrd-font-size) * 0.375);}.go2224423957:hover{background-color:#292e3d;}.go2224423957::after{content:' ';position:absolute;top:100%;left:-calc(var(--tsrd-font-size) * 0.625);height:calc(var(--tsrd-font-size) * 0.375);width:calc(100% + calc(var(--tsrd-font-size) * 1.25));}.go959131266{color:#98a2b3;width:calc(var(--tsrd-font-size) * 0.5);height:calc(var(--tsrd-font-size) * 0.5);}.go1702243790{background:none;border:none;padding:0 0 0 4px;margin:0;color:#98a2b3;font-size:var(--tsrd-font-size);cursor:pointer;line-height:1;vertical-align:middle;margin-right:0.5ch;flex-shrink:0;}.go1702243790:hover{color:#84CAFF;}.go1639696032{visibility:hidden;}.go3383159955{transition:all 0.4s ease;}.go844172998{pointer-events:none;transform:translateY(516px);}.go2902208695{bottom:calc(var(--tsrd-font-size) * 0.5);left:calc(var(--tsrd-font-size) * 0.5);}.go2279492678{opacity:1;pointer-events:auto;visibility:visible;}.go898539426{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;font-size:calc(var(--tsrd-font-size) * 0.75);line-height:calc(var(--tsrd-font-size) * 1.25);outline:none;word-break:break-word;}.go384656671{cursor:pointer;color:inherit;font:inherit;outline:inherit;background:transparent;border:none;padding:0;}.go2272256769{display:inline-flex;align-items:center;justify-content:center;width:calc(var(--tsrd-font-size) * 0.75);height:calc(var(--tsrd-font-size) * 0.75);padding-left:3px;box-sizing:content-box;}.go1058205856{display:flex;gap:calc(var(--tsrd-font-size) * 0.25);align-items:center;cursor:pointer;color:inherit;font:inherit;outline:inherit;background:transparent;border:none;padding:0;}.go1863549978{color:#9B8AFB;}.go1244333964{margin-left:calc(var(--tsrd-font-size) * 0.5);padding-left:calc(var(--tsrd-font-size) * 0.5);border-left:2px solid #313749;}.go2916152260{color:#667085;font-size:calc(var(--tsrd-font-size) * 0.625);padding-left:calc(var(--tsrd-font-size) * 0.25);}.go1577198724{appearance:none;border:0;cursor:pointer;background:transparent;color:inherit;padding:0;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;font-size:calc(var(--tsrd-font-size) * 0.75);}.go3879208559{transform:rotate(90deg);transition:transform 0.1s ease;}.go1560190766{transform:rotate(0deg);transition:transform 0.1s ease;}.go339260511{flex:1 0 auto;display:flex;justify-content:space-between;align-items:center;font-size:calc(var(--tsrd-font-size) * 0.75);line-height:calc(var(--tsrd-font-size) * 1);}.go3515246205{display:flex;border-bottom:1px solid #313749;align-items:center;padding:calc(var(--tsrd-font-size) * 0.25) calc(var(--tsrd-font-size) * 0.5);gap:calc(var(--tsrd-font-size) * 0.5);font-size:calc(var(--tsrd-font-size) * 0.75);color:#d0d5dd;cursor:pointer;line-height:calc(var(--tsrd-font-size) * 1);}.go4274307370{flex:0 0 auto;width:calc(var(--tsrd-font-size) * 0.75);height:calc(var(--tsrd-font-size) * 0.75);background:#054F31;border:1px solid #12B76A;border-radius:9999px;transition:all 0.25s ease-out;box-sizing:border-box;}.go3756382115{color:#98a2b3;}.go1091339057{display:flex;border-bottom:1px solid #313749;align-items:center;padding:calc(var(--tsrd-font-size) * 0.25) calc(var(--tsrd-font-size) * 0.5);gap:calc(var(--tsrd-font-size) * 0.5);font-size:calc(var(--tsrd-font-size) * 0.75);color:#d0d5dd;cursor:default;line-height:calc(var(--tsrd-font-size) * 1);}.go1960959592{flex:0 0 auto;width:calc(var(--tsrd-font-size) * 0.75);height:calc(var(--tsrd-font-size) * 0.75);background:#101828;border:1px solid #667085;border-radius:9999px;transition:all 0.25s ease-out;box-sizing:border-box;}.go3595285728{background:#344054;border-color:#98a2b3;}.go3874423951{margin-left:0;border-left:;}.go3643664686{appearance:none;border:none;font-size:12px;padding:4px 8px;background:transparent;cursor:pointer;font-family:ui-sans-serif, Inter, system-ui, sans-serif, sans-serif;font-weight:500;}.go2107851696{background:#313749;color:#d0d5dd;}.go1232428028{border-right:1px solid #667085;}.go862916629{color:#667085;background:#11131833;}.go3752837924{display:flex;border-bottom:1px solid #313749;cursor:pointer;align-items:center;padding:calc(var(--tsrd-font-size) * 0.25) calc(var(--tsrd-font-size) * 0.5);gap:calc(var(--tsrd-font-size) * 0.5);font-size:calc(var(--tsrd-font-size) * 0.75);color:#d0d5dd;}</style></head>
  <body>
    <div id="root"><div data-slot="sidebar-wrapper" class="group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full" style="--sidebar-width: 16rem; --sidebar-width-icon: 3rem;"><div class="flex w-full overflow-hidden min-h-screen"><div class="group peer text-sidebar-foreground hidden md:block" data-state="expanded" data-collapsible="" data-variant="inset" data-side="left" data-slot="sidebar"><div class="relative h-svh w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear group-data-[collapsible=offcanvas]:w-0 group-data-[side=right]:rotate-180 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]"></div><div class="fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)] p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)] border-r"><div data-sidebar="sidebar" class="bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm"><div data-slot="sidebar-header" data-sidebar="header" class="flex flex-col gap-2 p-4 border-b dark:border-gray-800"><a href="/tidy-ts/" class="flex items-center gap-2 hover:opacity-75 transition-opacity"><img alt="Tidy-TS Logo" class="h-10 w-10" src="/tidy-ts/src/assets/tidy-ts-logo-v2.svg"><h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Tidy-TS</h2></a></div><div data-slot="sidebar-content" data-sidebar="content" class="flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden"><div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-1"><li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative"><a data-slot="sidebar-menu-button" data-sidebar="menu-button" data-size="default" data-active="false" href="/tidy-ts/" class="peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground h-8 text-sm flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-house h-4 w-4"><path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"></path><path d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>Home</a></li><li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative"><a data-slot="sidebar-menu-button" data-sidebar="menu-button" data-size="default" data-active="false" href="/tidy-ts/getting-started" class="peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground h-8 text-sm flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open h-4 w-4"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg>Getting Started</a></li></ul></div><div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><div data-state="open" data-slot="collapsible"><button type="button" aria-controls="radix-«r0»" aria-expanded="true" data-state="open" data-slot="sidebar-group-label" class="text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex items-center gap-2 text-sm font-medium" data-sidebar="group-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-database h-4 w-4"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M3 5V19A9 3 0 0 0 21 19V5"></path><path d="M3 12A9 3 0 0 0 21 12"></path></svg>Core Operations<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 ml-auto"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="open" id="radix-«r0»" data-slot="collapsible-content" style="transition-duration: 0s; animation-name: none; --radix-collapsible-content-height: 288px; --radix-collapsible-content-width: 223px;"><div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm"><ul data-slot="sidebar-menu-sub" data-sidebar="menu-sub" class="border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5 group-data-[collapsible=icon]:hidden"><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/creating-dataframes" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Creating DataFrames</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/data-io" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Data I/O Operations</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/dataframe-basics" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">DataFrame Basics</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/transforming-data" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Transforming Data</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/filtering-rows" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Filtering Rows</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/selecting-columns" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Selecting Columns</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/sorting-arranging" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Sorting &amp; Arranging</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/async-operations" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Async Operations</a></li></ul></div></div></div></div><div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><div data-state="open" data-slot="collapsible"><button type="button" aria-controls="radix-«r1»" aria-expanded="true" data-state="open" data-slot="sidebar-group-label" class="text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex items-center gap-2 text-sm font-medium" data-sidebar="group-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chart-no-axes-column-increasing h-4 w-4"><line x1="12" x2="12" y1="20" y2="10"></line><line x1="18" x2="18" y1="20" y2="4"></line><line x1="6" x2="6" y1="20" y2="16"></line></svg>Data Operations<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 ml-auto"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="open" id="radix-«r1»" data-slot="collapsible-content" style="transition-duration: 0s; animation-name: none; --radix-collapsible-content-height: 216px; --radix-collapsible-content-width: 223px;"><div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm"><ul data-slot="sidebar-menu-sub" data-sidebar="menu-sub" class="border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5 group-data-[collapsible=icon]:hidden"><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/grouping-aggregation" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Grouping &amp; Aggregation</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/joining-dataframes" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Joining DataFrames</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/reshaping-data" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Reshaping Data</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/missing-data" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Missing Data Handling</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/stats-module" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Stats Module</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/data-visualization" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Data Visualization</a></li></ul></div></div></div></div><div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><div data-state="open" data-slot="collapsible"><button type="button" aria-controls="radix-«r2»" aria-expanded="true" data-state="open" data-slot="sidebar-group-label" class="text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex items-center gap-2 text-sm font-medium" data-sidebar="group-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code h-4 w-4"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>Other Features<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 ml-auto"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="open" id="radix-«r2»" data-slot="collapsible-content" style="transition-duration: 0s; animation-name: none; --radix-collapsible-content-height: 124px; --radix-collapsible-content-width: 223px;"><div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm"><ul data-slot="sidebar-menu-sub" data-sidebar="menu-sub" class="border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5 group-data-[collapsible=icon]:hidden"><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/combining-dataframes" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Combining DataFrames</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/transposing-data" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Transposing Data</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/performance-benchmarks" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Performance Benchmarks</a></li></ul></div></div></div></div><div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2 mb-26"><div data-state="open" data-slot="collapsible"><button type="button" aria-controls="radix-«r3»" aria-expanded="true" data-state="open" data-slot="sidebar-group-label" class="text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex items-center gap-2 text-sm font-medium" data-sidebar="group-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code h-4 w-4"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>Examples &amp; Tutorials<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 ml-auto"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="open" id="radix-«r3»" data-slot="collapsible-content" style="transition-duration: 0s; animation-name: none; --radix-collapsible-content-height: 72px; --radix-collapsible-content-width: 223px;"><div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm"><ul data-slot="sidebar-menu-sub" data-sidebar="menu-sub" class="border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5 group-data-[collapsible=icon]:hidden"><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm active" href="/tidy-ts/examples/comprehensive-workflows" data-status="active" aria-current="page">Example Workflows</a></li><li data-slot="sidebar-menu-sub-item" data-sidebar="menu-sub-item" class="group/menu-sub-item relative"><a data-slot="sidebar-menu-sub-button" data-sidebar="menu-sub-button" data-size="md" data-active="false" href="/tidy-ts/examples/jupyter-notebooks" class="text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&amp;&gt;svg]:text-sidebar-accent-foreground flex min-h-8 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 py-1 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground text-sm group-data-[collapsible=icon]:hidden text-sm">Jupyter Notebooks</a></li></ul></div></div></div></div></div></div></div></div><main data-slot="sidebar-inset" class="bg-background relative min-h-svh flex-1 peer-data-[variant=inset]:min-h-[calc(100svh-(--spacing(4)))] flex flex-col"><header class="flex h-[60px] items-center justify-between bg-white dark:bg-gray-900 px-3 lg:px-4 border-b min-w-0 sticky top-0 z-40"><div class="flex items-center flex-1 min-w-0 gap-4 lg:gap-6"><button data-slot="sidebar-trigger" class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:text-accent-foreground size-9 h-7 w-7 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md p-2 flex-shrink-0" data-sidebar="trigger" aria-label="Toggle sidebar"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-panel-left"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path></svg><span class="sr-only">Toggle Sidebar</span></button><a href="/tidy-ts/" class="hover:opacity-75 transition-opacity flex items-center gap-2 lg:gap-3 flex-shrink-0"><div class="flex items-center gap-1"><img alt="Tidy-TS Logo" class="h-10 w-10" src="/tidy-ts/src/assets/tidy-ts-logo-v2.svg"></div><div class="hidden md:block"><h1 class="font-semibold text-gray-900 dark:text-gray-100 text-lg">Tidy-TS</h1></div></a><div class="flex-1 min-w-0"><button data-slot="button" class="inline-flex items-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2 has-[&gt;svg]:px-3 text-muted-foreground min-w-0 w-full max-w-sm justify-start"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search h-4 w-4 mr-2 flex-shrink-0"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg><span class="hidden sm:inline">Search docs...</span><span class="sm:hidden">Search</span><kbd class="hidden sm:inline-flex ml-auto pointer-events-none h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100">⌘K</kbd></button></div></div><div class="flex items-center gap-1 lg:gap-2 flex-shrink-0"><a href="https://github.com/jtmenchaca/tidy-ts" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent h-8 rounded-md px-3 has-[&gt;svg]:px-2.5 text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100 flex items-center gap-1 lg:gap-2" data-slot="button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github w-5 h-5"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg><span class="hidden lg:inline">GitHub</span></a><button type="button" aria-label="Toggle theme" class="shrink-0 h-9 w-9 p-1 cursor-pointer rounded border border-transparent transition-colors duration-200 ease-in-out text-gray-600 hover:bg-gray-100 hover:border-gray-200 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:border-gray-700 flex flex-col items-center justify-center overflow-hidden relative"><div class="relative w-5 h-5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute inset-0 w-5 h-5 transition-transform duration-200 transform scale-100 rotate-0"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun absolute inset-0 w-5 h-5 transition-transform duration-200 transform scale-0 rotate-90"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg></div><span class="sr-only">Switch to dark theme</span></button></div></header><main class="flex-1 bg-white dark:bg-gray-900 overflow-y-auto min-w-0"><div class="flex-1 p-8 overflow-y-auto"><div class="max-w-4xl mx-auto space-y-8"><div class="mb-8"><h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-4">Comprehensive Workflows</h1><p class="text-lg text-gray-600 dark:text-gray-400">Real-world data analysis workflows that combine all tidy-ts features. These examples show how to use the library effectively.</p></div><div data-slot="card" class="bg-card text-card-foreground flex flex-col gap-4 sm:gap-6 rounded-xl border py-4 sm:py-6 shadow-sm min-w-0 overflow-hidden"><div data-slot="card-header" class="@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-3 sm:px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 min-w-0"><div data-slot="card-title" class="leading-none font-semibold min-w-0 break-words">Complete Data Analysis Pipeline</div><div data-slot="card-description" class="text-muted-foreground text-sm min-w-0 break-words">A complete workflow combining all major tidy-ts operations</div></div><div data-slot="card-content" class="px-3 sm:px-6 min-w-0"><p class="mb-4">This example demonstrates a complete data analysis workflow from data loading through transformation, filtering, grouping, and summarization.</p><div class="relative w-full group [&amp;_pre]:!p-4 [&amp;_pre]:!m-0 [&amp;_pre]:!rounded-md [&amp;_pre]:!overflow-x-auto [&amp;_pre]:!text-xs [&amp;_pre]:!font-mono [&amp;_pre]:!bg-[rgb(246,248,250)] dark:[&amp;_pre]:!bg-[rgb(20,20,20)]"><button class="absolute top-2 right-2 p-2 rounded-md bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700 transition-colors opacity-100 z-10 cursor-pointer" aria-label="Copy code"><div class="relative w-4 h-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check h-4 w-4 text-green-600 dark:text-green-400 transition-all duration-200 opacity-0 scale-75 absolute inset-0"><path d="M20 6 9 17l-5-5"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-4 w-4 text-gray-600 dark:text-gray-400 transition-all duration-200 opacity-100 scale-100 absolute inset-0"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></div></button><div class="[&amp;&gt;pre.shiki:first-child]:block [&amp;&gt;pre.shiki:last-child]:hidden dark:[&amp;&gt;pre.shiki:first-child]:hidden dark:[&amp;&gt;pre.shiki:last-child]:block"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> { createDataFrame, stats </span><span style="color:#D73A49">as</span><span style="color:#24292E"> s, readCSV } </span><span style="color:#D73A49">from</span><span style="color:#032F62"> "@tidy-ts/dataframe"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> { z } </span><span style="color:#D73A49">from</span><span style="color:#032F62"> "zod"</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 1. Load and validate data</span></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> PersonSchema</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> z.</span><span style="color:#6F42C1">object</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#24292E">  name: z.</span><span style="color:#6F42C1">string</span><span style="color:#24292E">(),</span></span>
<span class="line"><span style="color:#24292E">  age: z.</span><span style="color:#6F42C1">number</span><span style="color:#24292E">(),</span></span>
<span class="line"><span style="color:#24292E">  city: z.</span><span style="color:#6F42C1">string</span><span style="color:#24292E">(),</span></span>
<span class="line"><span style="color:#24292E">  score: z.</span><span style="color:#6F42C1">number</span><span style="color:#24292E">(),</span></span>
<span class="line"><span style="color:#24292E">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> csvData</span><span style="color:#D73A49"> =</span><span style="color:#032F62"> `name,age,city,score</span></span>
<span class="line"><span style="color:#032F62">Alice,25,New York,85</span></span>
<span class="line"><span style="color:#032F62">Bob,30,Los Angeles,92</span></span>
<span class="line"><span style="color:#032F62">Carol,28,Chicago,78</span></span>
<span class="line"><span style="color:#032F62">Dave,35,Houston,88`</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> people</span><span style="color:#D73A49"> =</span><span style="color:#D73A49"> await</span><span style="color:#6F42C1"> readCSV</span><span style="color:#24292E">(csvData, PersonSchema);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 2. Complete analysis pipeline</span></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> analysis</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> people</span></span>
<span class="line"><span style="color:#6A737D">  // Transform data</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">mutate</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6F42C1">    age_group</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (row.age </span><span style="color:#D73A49">&lt;</span><span style="color:#005CC5"> 25</span><span style="color:#24292E">) </span><span style="color:#D73A49">return</span><span style="color:#032F62"> "Young"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (row.age </span><span style="color:#D73A49">&lt;</span><span style="color:#005CC5"> 35</span><span style="color:#24292E">) </span><span style="color:#D73A49">return</span><span style="color:#032F62"> "Adult"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#032F62"> "Senior"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">    },</span></span>
<span class="line"><span style="color:#6F42C1">    score_category</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (row.score </span><span style="color:#D73A49">&gt;=</span><span style="color:#005CC5"> 90</span><span style="color:#24292E">) </span><span style="color:#D73A49">return</span><span style="color:#032F62"> "Excellent"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (row.score </span><span style="color:#D73A49">&gt;=</span><span style="color:#005CC5"> 80</span><span style="color:#24292E">) </span><span style="color:#D73A49">return</span><span style="color:#032F62"> "Good"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (row.score </span><span style="color:#D73A49">&gt;=</span><span style="color:#005CC5"> 70</span><span style="color:#24292E">) </span><span style="color:#D73A49">return</span><span style="color:#032F62"> "Fair"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#032F62"> "Poor"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">    },</span></span>
<span class="line"><span style="color:#6F42C1">    z_score</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">, </span><span style="color:#E36209">_index</span><span style="color:#24292E">, </span><span style="color:#E36209">df</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      const</span><span style="color:#005CC5"> mean</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">mean</span><span style="color:#24292E">(df.score);</span></span>
<span class="line"><span style="color:#D73A49">      const</span><span style="color:#005CC5"> std</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">stdev</span><span style="color:#24292E">(df.score);</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">((row.score </span><span style="color:#D73A49">-</span><span style="color:#24292E"> mean) </span><span style="color:#D73A49">/</span><span style="color:#24292E"> std, </span><span style="color:#005CC5">3</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    },</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#6A737D">  // Filter data</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">filter</span><span style="color:#24292E">((</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.score </span><span style="color:#D73A49">&gt;=</span><span style="color:#005CC5"> 80</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#6A737D">  // Group and summarize</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">groupBy</span><span style="color:#24292E">(</span><span style="color:#032F62">"age_group"</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">summarise</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6F42C1">    count</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> group.</span><span style="color:#6F42C1">nrows</span><span style="color:#24292E">(),</span></span>
<span class="line"><span style="color:#6F42C1">    avg_score</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">(s.</span><span style="color:#6F42C1">mean</span><span style="color:#24292E">(group.score), </span><span style="color:#005CC5">2</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#6F42C1">    max_score</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">max</span><span style="color:#24292E">(group.score),</span></span>
<span class="line"><span style="color:#6F42C1">    min_score</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">min</span><span style="color:#24292E">(group.score),</span></span>
<span class="line"><span style="color:#6F42C1">    score_std</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">(s.</span><span style="color:#6F42C1">stdev</span><span style="color:#24292E">(group.score), </span><span style="color:#005CC5">2</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#6A737D">  // Sort results</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">arrange</span><span style="color:#24292E">(</span><span style="color:#032F62">"avg_score"</span><span style="color:#24292E">, </span><span style="color:#032F62">"desc"</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">analysis.</span><span style="color:#6F42C1">print</span><span style="color:#24292E">(</span><span style="color:#032F62">"Complete analysis results:"</span><span style="color:#24292E">);</span></span></code></pre><pre class="shiki tokyo-night" style="background-color:#1a1b26;color:#a9b1d6" tabindex="0"><code><span class="line"><span style="color:#7DCFFF">import</span><span style="color:#9ABDF5"> { </span><span style="color:#0DB9D7">createDataFrame</span><span style="color:#89DDFF">,</span><span style="color:#C0CAF5"> stats</span><span style="color:#89DDFF"> as</span><span style="color:#0DB9D7"> s</span><span style="color:#89DDFF">,</span><span style="color:#0DB9D7"> readCSV</span><span style="color:#9ABDF5"> }</span><span style="color:#7DCFFF"> from</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">@tidy-ts/dataframe</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#7DCFFF">import</span><span style="color:#9ABDF5"> { </span><span style="color:#0DB9D7">z</span><span style="color:#9ABDF5"> }</span><span style="color:#7DCFFF"> from</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">zod</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#51597D;font-style:italic">// 1. Load and validate data</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> PersonSchema</span><span style="color:#89DDFF"> =</span><span style="color:#C0CAF5"> z</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">object</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#73DACA">  name</span><span style="color:#89DDFF">:</span><span style="color:#C0CAF5"> z</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">string</span><span style="color:#9ABDF5">()</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#73DACA">  age</span><span style="color:#89DDFF">:</span><span style="color:#C0CAF5"> z</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">number</span><span style="color:#9ABDF5">()</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#73DACA">  city</span><span style="color:#89DDFF">:</span><span style="color:#C0CAF5"> z</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">string</span><span style="color:#9ABDF5">()</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#73DACA">  score</span><span style="color:#89DDFF">:</span><span style="color:#C0CAF5"> z</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">number</span><span style="color:#9ABDF5">()</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">})</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> csvData</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> `</span><span style="color:#9ECE6A">name,age,city,score</span></span>
<span class="line"><span style="color:#9ECE6A">Alice,25,New York,85</span></span>
<span class="line"><span style="color:#9ECE6A">Bob,30,Los Angeles,92</span></span>
<span class="line"><span style="color:#9ECE6A">Carol,28,Chicago,78</span></span>
<span class="line"><span style="color:#9ECE6A">Dave,35,Houston,88</span><span style="color:#89DDFF">`</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> people</span><span style="color:#89DDFF"> =</span><span style="color:#BB9AF7;font-style:italic"> await</span><span style="color:#7AA2F7"> readCSV</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">csvData</span><span style="color:#89DDFF">,</span><span style="color:#C0CAF5"> PersonSchema</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#51597D;font-style:italic">// 2. Complete analysis pipeline</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> analysis</span><span style="color:#89DDFF"> =</span><span style="color:#C0CAF5"> people</span></span>
<span class="line"><span style="color:#51597D;font-style:italic">  // Transform data</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">mutate</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#7AA2F7">    age_group</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#9ABDF5"> {</span></span>
<span class="line"><span style="color:#BB9AF7">      if</span><span style="color:#9ABDF5"> (</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">age</span><span style="color:#BB9AF7"> &lt;</span><span style="color:#FF9E64"> 25</span><span style="color:#9ABDF5">) </span><span style="color:#BB9AF7;font-style:italic">return</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Young</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7">      if</span><span style="color:#9ABDF5"> (</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">age</span><span style="color:#BB9AF7"> &lt;</span><span style="color:#FF9E64"> 35</span><span style="color:#9ABDF5">) </span><span style="color:#BB9AF7;font-style:italic">return</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Adult</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">      return</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Senior</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9ABDF5">    }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    score_category</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#9ABDF5"> {</span></span>
<span class="line"><span style="color:#BB9AF7">      if</span><span style="color:#9ABDF5"> (</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#BB9AF7"> &gt;=</span><span style="color:#FF9E64"> 90</span><span style="color:#9ABDF5">) </span><span style="color:#BB9AF7;font-style:italic">return</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Excellent</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7">      if</span><span style="color:#9ABDF5"> (</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#BB9AF7"> &gt;=</span><span style="color:#FF9E64"> 80</span><span style="color:#9ABDF5">) </span><span style="color:#BB9AF7;font-style:italic">return</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Good</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7">      if</span><span style="color:#9ABDF5"> (</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#BB9AF7"> &gt;=</span><span style="color:#FF9E64"> 70</span><span style="color:#9ABDF5">) </span><span style="color:#BB9AF7;font-style:italic">return</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Fair</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">      return</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Poor</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9ABDF5">    }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    z_score</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#89DDFF">,</span><span style="color:#E0AF68"> _index</span><span style="color:#89DDFF">,</span><span style="color:#E0AF68"> df</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#9ABDF5"> {</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">      const</span><span style="color:#BB9AF7"> mean</span><span style="color:#89DDFF"> =</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">mean</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">df</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">      const</span><span style="color:#BB9AF7"> std</span><span style="color:#89DDFF"> =</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">stdev</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">df</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">      return</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">((</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#89DDFF"> -</span><span style="color:#C0CAF5"> mean</span><span style="color:#9ABDF5">) </span><span style="color:#89DDFF">/</span><span style="color:#C0CAF5"> std</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 3</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9ABDF5">    }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#51597D;font-style:italic">  // Filter data</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">filter</span><span style="color:#9ABDF5">((</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#BB9AF7"> &gt;=</span><span style="color:#FF9E64"> 80</span><span style="color:#9ABDF5">)</span></span>
<span class="line"><span style="color:#51597D;font-style:italic">  // Group and summarize</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">groupBy</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">age_group</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">summarise</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#7AA2F7">    count</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> group</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">nrows</span><span style="color:#9ABDF5">()</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    avg_score</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">mean</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 2</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    max_score</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">max</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    min_score</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">min</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    score_std</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">stdev</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 2</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#51597D;font-style:italic">  // Sort results</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">arrange</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">avg_score</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">desc</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C0CAF5">analysis</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">print</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">Complete analysis results:</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span></code></pre></div></div></div></div><div data-slot="card" class="bg-card text-card-foreground flex flex-col gap-4 sm:gap-6 rounded-xl border py-4 sm:py-6 shadow-sm min-w-0 overflow-hidden"><div data-slot="card-header" class="@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-3 sm:px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 min-w-0"><div data-slot="card-title" class="leading-none font-semibold min-w-0 break-words">Async Data Enrichment Workflow</div><div data-slot="card-description" class="text-muted-foreground text-sm min-w-0 break-words">Handling asynchronous operations in a real-world data pipeline</div></div><div data-slot="card-content" class="px-3 sm:px-6 min-w-0"><p class="mb-4">This workflow shows how to handle asynchronous operations like API calls and data validation while maintaining type safety and performance.</p><div class="relative w-full group [&amp;_pre]:!p-4 [&amp;_pre]:!m-0 [&amp;_pre]:!rounded-md [&amp;_pre]:!overflow-x-auto [&amp;_pre]:!text-xs [&amp;_pre]:!font-mono [&amp;_pre]:!bg-[rgb(246,248,250)] dark:[&amp;_pre]:!bg-[rgb(20,20,20)]"><button class="absolute top-2 right-2 p-2 rounded-md bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700 transition-colors opacity-100 z-10 cursor-pointer" aria-label="Copy code"><div class="relative w-4 h-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check h-4 w-4 text-green-600 dark:text-green-400 transition-all duration-200 opacity-0 scale-75 absolute inset-0"><path d="M20 6 9 17l-5-5"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-4 w-4 text-gray-600 dark:text-gray-400 transition-all duration-200 opacity-100 scale-100 absolute inset-0"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></div></button><div class="[&amp;&gt;pre.shiki:first-child]:block [&amp;&gt;pre.shiki:last-child]:hidden dark:[&amp;&gt;pre.shiki:first-child]:hidden dark:[&amp;&gt;pre.shiki:last-child]:block"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#6A737D">// Simulate external API calls</span></span>
<span class="line"><span style="color:#D73A49">async</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> fetchRegionalBonus</span><span style="color:#24292E">(</span><span style="color:#E36209">region</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> string</span><span style="color:#24292E">)</span><span style="color:#D73A49">:</span><span style="color:#6F42C1"> Promise</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">number</span><span style="color:#24292E">&gt; {</span></span>
<span class="line"><span style="color:#D73A49">  await</span><span style="color:#D73A49"> new</span><span style="color:#005CC5"> Promise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#6F42C1"> setTimeout</span><span style="color:#24292E">(resolve, </span><span style="color:#005CC5">1</span><span style="color:#24292E">));</span></span>
<span class="line"><span style="color:#D73A49">  const</span><span style="color:#005CC5"> bonuses</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> { </span><span style="color:#032F62">"North"</span><span style="color:#24292E">: </span><span style="color:#005CC5">1.2</span><span style="color:#24292E">, </span><span style="color:#032F62">"South"</span><span style="color:#24292E">: </span><span style="color:#005CC5">1.1</span><span style="color:#24292E">, </span><span style="color:#032F62">"East"</span><span style="color:#24292E">: </span><span style="color:#005CC5">1.15</span><span style="color:#24292E">, </span><span style="color:#032F62">"West"</span><span style="color:#24292E">: </span><span style="color:#005CC5">1.05</span><span style="color:#24292E"> };</span></span>
<span class="line"><span style="color:#D73A49">  return</span><span style="color:#24292E"> bonuses[region </span><span style="color:#D73A49">as</span><span style="color:#D73A49"> keyof</span><span style="color:#D73A49"> typeof</span><span style="color:#24292E"> bonuses] </span><span style="color:#D73A49">||</span><span style="color:#005CC5"> 1.0</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">async</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> validateDataQuality</span><span style="color:#24292E">(</span><span style="color:#E36209">score</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> number</span><span style="color:#24292E">)</span><span style="color:#D73A49">:</span><span style="color:#6F42C1"> Promise</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">boolean</span><span style="color:#24292E">&gt; {</span></span>
<span class="line"><span style="color:#D73A49">  await</span><span style="color:#D73A49"> new</span><span style="color:#005CC5"> Promise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#6F42C1"> setTimeout</span><span style="color:#24292E">(resolve, </span><span style="color:#005CC5">1</span><span style="color:#24292E">));</span></span>
<span class="line"><span style="color:#D73A49">  return</span><span style="color:#24292E"> score </span><span style="color:#D73A49">&gt;=</span><span style="color:#005CC5"> 0</span><span style="color:#D73A49"> &amp;&amp;</span><span style="color:#24292E"> score </span><span style="color:#D73A49">&lt;=</span><span style="color:#005CC5"> 100</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// Sales data</span></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> salesData</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> createDataFrame</span><span style="color:#24292E">([</span></span>
<span class="line"><span style="color:#24292E">  { id: </span><span style="color:#005CC5">1</span><span style="color:#24292E">, region: </span><span style="color:#032F62">"North"</span><span style="color:#24292E">, product: </span><span style="color:#032F62">"Widget A"</span><span style="color:#24292E">, sales: </span><span style="color:#005CC5">1000</span><span style="color:#24292E">, quarter: </span><span style="color:#032F62">"Q1"</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { id: </span><span style="color:#005CC5">2</span><span style="color:#24292E">, region: </span><span style="color:#032F62">"South"</span><span style="color:#24292E">, product: </span><span style="color:#032F62">"Widget B"</span><span style="color:#24292E">, sales: </span><span style="color:#005CC5">800</span><span style="color:#24292E">, quarter: </span><span style="color:#032F62">"Q1"</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { id: </span><span style="color:#005CC5">3</span><span style="color:#24292E">, region: </span><span style="color:#032F62">"East"</span><span style="color:#24292E">, product: </span><span style="color:#032F62">"Widget A"</span><span style="color:#24292E">, sales: </span><span style="color:#005CC5">1200</span><span style="color:#24292E">, quarter: </span><span style="color:#032F62">"Q1"</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { id: </span><span style="color:#005CC5">4</span><span style="color:#24292E">, region: </span><span style="color:#032F62">"West"</span><span style="color:#24292E">, product: </span><span style="color:#032F62">"Widget B"</span><span style="color:#24292E">, sales: </span><span style="color:#005CC5">900</span><span style="color:#24292E">, quarter: </span><span style="color:#032F62">"Q1"</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// Complete async workflow</span></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> enrichedAnalysis</span><span style="color:#D73A49"> =</span><span style="color:#D73A49"> await</span><span style="color:#24292E"> salesData</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">mutate</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6A737D">    // Sync operations</span></span>
<span class="line"><span style="color:#6F42C1">    product_category</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.product.</span><span style="color:#6F42C1">includes</span><span style="color:#24292E">(</span><span style="color:#032F62">"A"</span><span style="color:#24292E">) </span><span style="color:#D73A49">?</span><span style="color:#032F62"> "Category A"</span><span style="color:#D73A49"> :</span><span style="color:#032F62"> "Category B"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#6A737D">    // Async operations</span></span>
<span class="line"><span style="color:#6F42C1">    regional_bonus</span><span style="color:#24292E">: </span><span style="color:#D73A49">async</span><span style="color:#24292E"> (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#D73A49"> await</span><span style="color:#6F42C1"> fetchRegionalBonus</span><span style="color:#24292E">(row.region),</span></span>
<span class="line"><span style="color:#6F42C1">    is_valid_sale</span><span style="color:#24292E">: </span><span style="color:#D73A49">async</span><span style="color:#24292E"> (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#D73A49"> await</span><span style="color:#6F42C1"> validateDataQuality</span><span style="color:#24292E">(row.sales),</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">filter</span><span style="color:#24292E">(</span><span style="color:#D73A49">async</span><span style="color:#24292E"> (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#D73A49"> await</span><span style="color:#24292E"> row.is_valid_sale)</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">mutate</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6F42C1">    adjusted_sales</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.sales </span><span style="color:#D73A49">*</span><span style="color:#24292E"> row.regional_bonus,</span></span>
<span class="line"><span style="color:#6F42C1">    performance_tier</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (row.adjusted_sales </span><span style="color:#D73A49">&gt;=</span><span style="color:#005CC5"> 1200</span><span style="color:#24292E">) </span><span style="color:#D73A49">return</span><span style="color:#032F62"> "High"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (row.adjusted_sales </span><span style="color:#D73A49">&gt;=</span><span style="color:#005CC5"> 900</span><span style="color:#24292E">) </span><span style="color:#D73A49">return</span><span style="color:#032F62"> "Medium"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#032F62"> "Low"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">    },</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">groupBy</span><span style="color:#24292E">(</span><span style="color:#032F62">"region"</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">summarise</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6F42C1">    total_sales</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">sum</span><span style="color:#24292E">(group.sales),</span></span>
<span class="line"><span style="color:#6F42C1">    total_adjusted</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">sum</span><span style="color:#24292E">(group.adjusted_sales),</span></span>
<span class="line"><span style="color:#6F42C1">    avg_bonus</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">(s.</span><span style="color:#6F42C1">mean</span><span style="color:#24292E">(group.regional_bonus), </span><span style="color:#005CC5">3</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#6F42C1">    high_performance_count</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> </span></span>
<span class="line"><span style="color:#24292E">      group.</span><span style="color:#6F42C1">filter</span><span style="color:#24292E">((</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.performance_tier </span><span style="color:#D73A49">===</span><span style="color:#032F62"> "High"</span><span style="color:#24292E">).</span><span style="color:#6F42C1">nrows</span><span style="color:#24292E">(),</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">arrange</span><span style="color:#24292E">(</span><span style="color:#032F62">"total_adjusted"</span><span style="color:#24292E">, </span><span style="color:#032F62">"desc"</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">enrichedAnalysis.</span><span style="color:#6F42C1">print</span><span style="color:#24292E">(</span><span style="color:#032F62">"Async enriched analysis:"</span><span style="color:#24292E">);</span></span></code></pre><pre class="shiki tokyo-night" style="background-color:#1a1b26;color:#a9b1d6" tabindex="0"><code><span class="line"><span style="color:#51597D;font-style:italic">// Simulate external API calls</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">async</span><span style="color:#BB9AF7"> function</span><span style="color:#7AA2F7"> fetchRegionalBonus</span><span style="color:#9ABDF5">(</span><span style="color:#E0AF68">region</span><span style="color:#89DDFF">:</span><span style="color:#0DB9D7"> string</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">:</span><span style="color:#C0CAF5"> Promise</span><span style="color:#89DDFF">&lt;</span><span style="color:#0DB9D7">number</span><span style="color:#89DDFF">&gt;</span><span style="color:#9ABDF5"> {</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">  await</span><span style="color:#89DDFF"> new</span><span style="color:#0DB9D7"> Promise</span><span style="color:#9ABDF5">((</span><span style="color:#E0AF68">resolve</span><span style="color:#9ABDF5">) </span><span style="color:#BB9AF7">=&gt;</span><span style="color:#7AA2F7"> setTimeout</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">resolve</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 1</span><span style="color:#9ABDF5">))</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">  const</span><span style="color:#BB9AF7"> bonuses</span><span style="color:#89DDFF"> =</span><span style="color:#9ABDF5"> { </span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">North</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1.2</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">South</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1.1</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">East</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1.15</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">West</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1.05</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">  return</span><span style="color:#C0CAF5"> bonuses</span><span style="color:#9ABDF5">[</span><span style="color:#7DCFFF">region</span><span style="color:#89DDFF"> as</span><span style="color:#89DDFF"> keyof</span><span style="color:#89DDFF"> typeof</span><span style="color:#7DCFFF"> bonuses</span><span style="color:#9ABDF5">] </span><span style="color:#BB9AF7">||</span><span style="color:#FF9E64"> 1.0</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9ABDF5">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">async</span><span style="color:#BB9AF7"> function</span><span style="color:#7AA2F7"> validateDataQuality</span><span style="color:#9ABDF5">(</span><span style="color:#E0AF68">score</span><span style="color:#89DDFF">:</span><span style="color:#0DB9D7"> number</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">:</span><span style="color:#C0CAF5"> Promise</span><span style="color:#89DDFF">&lt;</span><span style="color:#0DB9D7">boolean</span><span style="color:#89DDFF">&gt;</span><span style="color:#9ABDF5"> {</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">  await</span><span style="color:#89DDFF"> new</span><span style="color:#0DB9D7"> Promise</span><span style="color:#9ABDF5">((</span><span style="color:#E0AF68">resolve</span><span style="color:#9ABDF5">) </span><span style="color:#BB9AF7">=&gt;</span><span style="color:#7AA2F7"> setTimeout</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">resolve</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 1</span><span style="color:#9ABDF5">))</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">  return</span><span style="color:#C0CAF5"> score</span><span style="color:#BB9AF7"> &gt;=</span><span style="color:#FF9E64"> 0</span><span style="color:#BB9AF7"> &amp;&amp;</span><span style="color:#C0CAF5"> score</span><span style="color:#BB9AF7"> &lt;=</span><span style="color:#FF9E64"> 100</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9ABDF5">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#51597D;font-style:italic">// Sales data</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> salesData</span><span style="color:#89DDFF"> =</span><span style="color:#7AA2F7"> createDataFrame</span><span style="color:#9ABDF5">([</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> region</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">North</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> product</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Widget A</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> sales</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1000</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> quarter</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Q1</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> region</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">South</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> product</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Widget B</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> sales</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 800</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> quarter</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Q1</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 3</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> region</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">East</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> product</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Widget A</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> sales</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1200</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> quarter</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Q1</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 4</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> region</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">West</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> product</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Widget B</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> sales</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 900</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> quarter</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Q1</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">])</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#51597D;font-style:italic">// Complete async workflow</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> enrichedAnalysis</span><span style="color:#89DDFF"> =</span><span style="color:#BB9AF7;font-style:italic"> await</span><span style="color:#C0CAF5"> salesData</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">mutate</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#51597D;font-style:italic">    // Sync operations</span></span>
<span class="line"><span style="color:#7AA2F7">    product_category</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">product</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">includes</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">A</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> ?</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Category A</span><span style="color:#89DDFF">"</span><span style="color:#BB9AF7"> :</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Category B</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#A9B1D6">    </span></span>
<span class="line"><span style="color:#51597D;font-style:italic">    // Async operations</span></span>
<span class="line"><span style="color:#7AA2F7">    regional_bonus</span><span style="color:#89DDFF">:</span><span style="color:#9D7CD8;font-style:italic"> async</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#BB9AF7;font-style:italic"> await</span><span style="color:#7AA2F7"> fetchRegionalBonus</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">region</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    is_valid_sale</span><span style="color:#89DDFF">:</span><span style="color:#9D7CD8;font-style:italic"> async</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#BB9AF7;font-style:italic"> await</span><span style="color:#7AA2F7"> validateDataQuality</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">sales</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">filter</span><span style="color:#9ABDF5">(</span><span style="color:#9D7CD8;font-style:italic">async</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#BB9AF7;font-style:italic"> await</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">is_valid_sale</span><span style="color:#9ABDF5">)</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">mutate</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#7AA2F7">    adjusted_sales</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">sales</span><span style="color:#89DDFF"> *</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">regional_bonus</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    performance_tier</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#9ABDF5"> {</span></span>
<span class="line"><span style="color:#BB9AF7">      if</span><span style="color:#9ABDF5"> (</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">adjusted_sales</span><span style="color:#BB9AF7"> &gt;=</span><span style="color:#FF9E64"> 1200</span><span style="color:#9ABDF5">) </span><span style="color:#BB9AF7;font-style:italic">return</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">High</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7">      if</span><span style="color:#9ABDF5"> (</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">adjusted_sales</span><span style="color:#BB9AF7"> &gt;=</span><span style="color:#FF9E64"> 900</span><span style="color:#9ABDF5">) </span><span style="color:#BB9AF7;font-style:italic">return</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Medium</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">      return</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Low</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9ABDF5">    }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">groupBy</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">region</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">summarise</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#7AA2F7">    total_sales</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">sum</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">sales</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    total_adjusted</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">sum</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">adjusted_sales</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    avg_bonus</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">mean</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">regional_bonus</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 3</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    high_performance_count</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#A9B1D6"> </span></span>
<span class="line"><span style="color:#C0CAF5">      group</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">filter</span><span style="color:#9ABDF5">((</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">performance_tier</span><span style="color:#BB9AF7"> ===</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">High</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">nrows</span><span style="color:#9ABDF5">()</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">arrange</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">total_adjusted</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">desc</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C0CAF5">enrichedAnalysis</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">print</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">Async enriched analysis:</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span></code></pre></div></div></div></div><div data-slot="card" class="bg-card text-card-foreground flex flex-col gap-4 sm:gap-6 rounded-xl border py-4 sm:py-6 shadow-sm min-w-0 overflow-hidden"><div data-slot="card-header" class="@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-3 sm:px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 min-w-0"><div data-slot="card-title" class="leading-none font-semibold min-w-0 break-words">Data Quality and Cleaning Pipeline</div><div data-slot="card-description" class="text-muted-foreground text-sm min-w-0 break-words">Comprehensive data cleaning and quality assessment</div></div><div data-slot="card-content" class="px-3 sm:px-6 min-w-0"><p class="mb-4">This workflow demonstrates comprehensive data quality assessment and cleaning, including missing data analysis and intelligent imputation strategies.</p><div class="relative w-full group [&amp;_pre]:!p-4 [&amp;_pre]:!m-0 [&amp;_pre]:!rounded-md [&amp;_pre]:!overflow-x-auto [&amp;_pre]:!text-xs [&amp;_pre]:!font-mono [&amp;_pre]:!bg-[rgb(246,248,250)] dark:[&amp;_pre]:!bg-[rgb(20,20,20)]"><button class="absolute top-2 right-2 p-2 rounded-md bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700 transition-colors opacity-100 z-10 cursor-pointer" aria-label="Copy code"><div class="relative w-4 h-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check h-4 w-4 text-green-600 dark:text-green-400 transition-all duration-200 opacity-0 scale-75 absolute inset-0"><path d="M20 6 9 17l-5-5"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-4 w-4 text-gray-600 dark:text-gray-400 transition-all duration-200 opacity-100 scale-100 absolute inset-0"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></div></button><div class="[&amp;&gt;pre.shiki:first-child]:block [&amp;&gt;pre.shiki:last-child]:hidden dark:[&amp;&gt;pre.shiki:first-child]:hidden dark:[&amp;&gt;pre.shiki:last-child]:block"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#6A737D">// Messy real-world data</span></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> messyData</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> createDataFrame</span><span style="color:#24292E">([</span></span>
<span class="line"><span style="color:#24292E">  { id: </span><span style="color:#005CC5">1</span><span style="color:#24292E">, name: </span><span style="color:#032F62">"Alice"</span><span style="color:#24292E">, age: </span><span style="color:#005CC5">25</span><span style="color:#24292E">, score: </span><span style="color:#005CC5">85</span><span style="color:#24292E">, active: </span><span style="color:#005CC5">true</span><span style="color:#24292E">, notes: </span><span style="color:#032F62">"Great"</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { id: </span><span style="color:#005CC5">2</span><span style="color:#24292E">, name: </span><span style="color:#005CC5">null</span><span style="color:#24292E">, age: </span><span style="color:#005CC5">30</span><span style="color:#24292E">, score: </span><span style="color:#005CC5">null</span><span style="color:#24292E">, active: </span><span style="color:#005CC5">true</span><span style="color:#24292E">, notes: </span><span style="color:#032F62">"Missing score"</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { id: </span><span style="color:#005CC5">3</span><span style="color:#24292E">, name: </span><span style="color:#032F62">"Charlie"</span><span style="color:#24292E">, age: </span><span style="color:#005CC5">null</span><span style="color:#24292E">, score: </span><span style="color:#005CC5">92</span><span style="color:#24292E">, active: </span><span style="color:#005CC5">false</span><span style="color:#24292E">, notes: </span><span style="color:#005CC5">null</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { id: </span><span style="color:#005CC5">4</span><span style="color:#24292E">, name: </span><span style="color:#032F62">"Diana"</span><span style="color:#24292E">, age: </span><span style="color:#005CC5">28</span><span style="color:#24292E">, score: </span><span style="color:#005CC5">NaN</span><span style="color:#24292E">, active: </span><span style="color:#005CC5">null</span><span style="color:#24292E">, notes: </span><span style="color:#032F62">"NaN score"</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { id: </span><span style="color:#005CC5">5</span><span style="color:#24292E">, name: </span><span style="color:#032F62">"Eve"</span><span style="color:#24292E">, age: </span><span style="color:#005CC5">35</span><span style="color:#24292E">, score: </span><span style="color:#005CC5">78</span><span style="color:#24292E">, active: </span><span style="color:#005CC5">true</span><span style="color:#24292E">, notes: </span><span style="color:#005CC5">undefined</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { id: </span><span style="color:#005CC5">6</span><span style="color:#24292E">, name: </span><span style="color:#032F62">""</span><span style="color:#24292E">, age: </span><span style="color:#005CC5">0</span><span style="color:#24292E">, score: </span><span style="color:#005CC5">88</span><span style="color:#24292E">, active: </span><span style="color:#005CC5">false</span><span style="color:#24292E">, notes: </span><span style="color:#032F62">"Empty string"</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// Data quality assessment</span></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> qualityAnalysis</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> messyData</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">mutate</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6A737D">    // Missing data indicators</span></span>
<span class="line"><span style="color:#6F42C1">    name_missing</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.name </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> null</span><span style="color:#D73A49"> ||</span><span style="color:#24292E"> row.name </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> undefined</span><span style="color:#D73A49"> ||</span><span style="color:#24292E"> row.name </span><span style="color:#D73A49">===</span><span style="color:#032F62"> ""</span><span style="color:#D73A49"> ?</span><span style="color:#005CC5"> 1</span><span style="color:#D73A49"> :</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">    age_missing</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.age </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> null</span><span style="color:#D73A49"> ||</span><span style="color:#24292E"> row.age </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> undefined</span><span style="color:#D73A49"> ?</span><span style="color:#005CC5"> 1</span><span style="color:#D73A49"> :</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">    score_missing</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.score </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> null</span><span style="color:#D73A49"> ||</span><span style="color:#24292E"> row.score </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> undefined</span><span style="color:#D73A49"> ||</span><span style="color:#6F42C1"> isNaN</span><span style="color:#24292E">(row.score) </span><span style="color:#D73A49">?</span><span style="color:#005CC5"> 1</span><span style="color:#D73A49"> :</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">    active_missing</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.active </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> null</span><span style="color:#D73A49"> ||</span><span style="color:#24292E"> row.active </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> undefined</span><span style="color:#D73A49"> ?</span><span style="color:#005CC5"> 1</span><span style="color:#D73A49"> :</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">    notes_missing</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.notes </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> null</span><span style="color:#D73A49"> ||</span><span style="color:#24292E"> row.notes </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> undefined</span><span style="color:#D73A49"> ?</span><span style="color:#005CC5"> 1</span><span style="color:#D73A49"> :</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">summarise</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6F42C1">    total_rows</span><span style="color:#24292E">: (</span><span style="color:#E36209">df</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> df.</span><span style="color:#6F42C1">nrows</span><span style="color:#24292E">(),</span></span>
<span class="line"><span style="color:#6F42C1">    name_missing</span><span style="color:#24292E">: (</span><span style="color:#E36209">df</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">sum</span><span style="color:#24292E">(df.name_missing),</span></span>
<span class="line"><span style="color:#6F42C1">    age_missing</span><span style="color:#24292E">: (</span><span style="color:#E36209">df</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">sum</span><span style="color:#24292E">(df.age_missing),</span></span>
<span class="line"><span style="color:#6F42C1">    score_missing</span><span style="color:#24292E">: (</span><span style="color:#E36209">df</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">sum</span><span style="color:#24292E">(df.score_missing),</span></span>
<span class="line"><span style="color:#6F42C1">    active_missing</span><span style="color:#24292E">: (</span><span style="color:#E36209">df</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">sum</span><span style="color:#24292E">(df.active_missing),</span></span>
<span class="line"><span style="color:#6F42C1">    notes_missing</span><span style="color:#24292E">: (</span><span style="color:#E36209">df</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">sum</span><span style="color:#24292E">(df.notes_missing),</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">mutate</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6F42C1">    name_missing_pct</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">((row.name_missing </span><span style="color:#D73A49">/</span><span style="color:#24292E"> row.total_rows) </span><span style="color:#D73A49">*</span><span style="color:#005CC5"> 100</span><span style="color:#24292E">, </span><span style="color:#005CC5">1</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#6F42C1">    age_missing_pct</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">((row.age_missing </span><span style="color:#D73A49">/</span><span style="color:#24292E"> row.total_rows) </span><span style="color:#D73A49">*</span><span style="color:#005CC5"> 100</span><span style="color:#24292E">, </span><span style="color:#005CC5">1</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#6F42C1">    score_missing_pct</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">((row.score_missing </span><span style="color:#D73A49">/</span><span style="color:#24292E"> row.total_rows) </span><span style="color:#D73A49">*</span><span style="color:#005CC5"> 100</span><span style="color:#24292E">, </span><span style="color:#005CC5">1</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#6F42C1">    active_missing_pct</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">((row.active_missing </span><span style="color:#D73A49">/</span><span style="color:#24292E"> row.total_rows) </span><span style="color:#D73A49">*</span><span style="color:#005CC5"> 100</span><span style="color:#24292E">, </span><span style="color:#005CC5">1</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#6F42C1">    notes_missing_pct</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">((row.notes_missing </span><span style="color:#D73A49">/</span><span style="color:#24292E"> row.total_rows) </span><span style="color:#D73A49">*</span><span style="color:#005CC5"> 100</span><span style="color:#24292E">, </span><span style="color:#005CC5">1</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#24292E">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">qualityAnalysis.</span><span style="color:#6F42C1">print</span><span style="color:#24292E">(</span><span style="color:#032F62">"Data quality analysis:"</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// Clean the data</span></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> cleanedData</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> messyData</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">mutate</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6A737D">    // Smart replacement using statistics</span></span>
<span class="line"><span style="color:#6F42C1">    name_cleaned</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.name </span><span style="color:#D73A49">||</span><span style="color:#032F62"> `Person_${</span><span style="color:#24292E">row</span><span style="color:#032F62">.</span><span style="color:#24292E">id</span><span style="color:#032F62">}`</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">    age_cleaned</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (row.age </span><span style="color:#D73A49">!==</span><span style="color:#005CC5"> null</span><span style="color:#D73A49"> &amp;&amp;</span><span style="color:#24292E"> row.age </span><span style="color:#D73A49">!==</span><span style="color:#005CC5"> undefined</span><span style="color:#24292E">) </span><span style="color:#D73A49">return</span><span style="color:#24292E"> row.age;</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#24292E"> row.active </span><span style="color:#D73A49">?</span><span style="color:#005CC5"> 30</span><span style="color:#D73A49"> :</span><span style="color:#005CC5"> 25</span><span style="color:#24292E">; </span><span style="color:#6A737D">// Different defaults based on other data</span></span>
<span class="line"><span style="color:#24292E">    },</span></span>
<span class="line"><span style="color:#6F42C1">    score_cleaned</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (row.score </span><span style="color:#D73A49">!==</span><span style="color:#005CC5"> null</span><span style="color:#D73A49"> &amp;&amp;</span><span style="color:#24292E"> row.score </span><span style="color:#D73A49">!==</span><span style="color:#005CC5"> undefined</span><span style="color:#D73A49"> &amp;&amp;</span><span style="color:#D73A49"> !</span><span style="color:#6F42C1">isNaN</span><span style="color:#24292E">(row.score)) {</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#24292E"> row.score;</span></span>
<span class="line"><span style="color:#24292E">      }</span></span>
<span class="line"><span style="color:#6A737D">      // Use median for missing scores</span></span>
<span class="line"><span style="color:#D73A49">      const</span><span style="color:#005CC5"> validScores</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> messyData.score.</span><span style="color:#6F42C1">filter</span><span style="color:#24292E">(</span><span style="color:#E36209">x</span><span style="color:#D73A49"> =&gt;</span><span style="color:#24292E"> x </span><span style="color:#D73A49">!==</span><span style="color:#005CC5"> null</span><span style="color:#D73A49"> &amp;&amp;</span><span style="color:#24292E"> x </span><span style="color:#D73A49">!==</span><span style="color:#005CC5"> undefined</span><span style="color:#D73A49"> &amp;&amp;</span><span style="color:#D73A49"> !</span><span style="color:#6F42C1">isNaN</span><span style="color:#24292E">(x));</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">median</span><span style="color:#24292E">(validScores, </span><span style="color:#005CC5">true</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    },</span></span>
<span class="line"><span style="color:#6F42C1">    active_cleaned</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.active </span><span style="color:#D73A49">??</span><span style="color:#005CC5"> true</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">    notes_cleaned</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row.notes </span><span style="color:#D73A49">||</span><span style="color:#032F62"> "No additional notes"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">select</span><span style="color:#24292E">(</span><span style="color:#032F62">"id"</span><span style="color:#24292E">, </span><span style="color:#032F62">"name_cleaned"</span><span style="color:#24292E">, </span><span style="color:#032F62">"age_cleaned"</span><span style="color:#24292E">, </span><span style="color:#032F62">"score_cleaned"</span><span style="color:#24292E">, </span><span style="color:#032F62">"active_cleaned"</span><span style="color:#24292E">, </span><span style="color:#032F62">"notes_cleaned"</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">cleanedData.</span><span style="color:#6F42C1">print</span><span style="color:#24292E">(</span><span style="color:#032F62">"Cleaned data:"</span><span style="color:#24292E">);</span></span></code></pre><pre class="shiki tokyo-night" style="background-color:#1a1b26;color:#a9b1d6" tabindex="0"><code><span class="line"><span style="color:#51597D;font-style:italic">// Messy real-world data</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> messyData</span><span style="color:#89DDFF"> =</span><span style="color:#7AA2F7"> createDataFrame</span><span style="color:#9ABDF5">([</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Alice</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> age</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 25</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> score</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 85</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> active</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> true</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> notes</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Great</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> name</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> null</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> age</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 30</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> score</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> null</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> active</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> true</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> notes</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Missing score</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 3</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Charlie</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> age</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> null</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> score</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 92</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> active</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> false</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> notes</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> null</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 4</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Diana</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> age</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 28</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> score</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> NaN</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> active</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> null</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> notes</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">NaN score</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 5</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Eve</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> age</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 35</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> score</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 78</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> active</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> true</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> notes</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> undefined</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 6</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> ""</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> age</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 0</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> score</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 88</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> active</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> false</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> notes</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Empty string</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">])</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#51597D;font-style:italic">// Data quality assessment</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> qualityAnalysis</span><span style="color:#89DDFF"> =</span><span style="color:#C0CAF5"> messyData</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">mutate</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#51597D;font-style:italic">    // Missing data indicators</span></span>
<span class="line"><span style="color:#7AA2F7">    name_missing</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">name</span><span style="color:#BB9AF7"> ===</span><span style="color:#FF9E64"> null</span><span style="color:#BB9AF7"> ||</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">name</span><span style="color:#BB9AF7"> ===</span><span style="color:#FF9E64"> undefined</span><span style="color:#BB9AF7"> ||</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">name</span><span style="color:#BB9AF7"> ===</span><span style="color:#89DDFF"> ""</span><span style="color:#BB9AF7"> ?</span><span style="color:#FF9E64"> 1</span><span style="color:#BB9AF7"> :</span><span style="color:#FF9E64"> 0</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    age_missing</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">age</span><span style="color:#BB9AF7"> ===</span><span style="color:#FF9E64"> null</span><span style="color:#BB9AF7"> ||</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">age</span><span style="color:#BB9AF7"> ===</span><span style="color:#FF9E64"> undefined</span><span style="color:#BB9AF7"> ?</span><span style="color:#FF9E64"> 1</span><span style="color:#BB9AF7"> :</span><span style="color:#FF9E64"> 0</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    score_missing</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#BB9AF7"> ===</span><span style="color:#FF9E64"> null</span><span style="color:#BB9AF7"> ||</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#BB9AF7"> ===</span><span style="color:#FF9E64"> undefined</span><span style="color:#BB9AF7"> ||</span><span style="color:#7AA2F7"> isNaN</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> ?</span><span style="color:#FF9E64"> 1</span><span style="color:#BB9AF7"> :</span><span style="color:#FF9E64"> 0</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    active_missing</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">active</span><span style="color:#BB9AF7"> ===</span><span style="color:#FF9E64"> null</span><span style="color:#BB9AF7"> ||</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">active</span><span style="color:#BB9AF7"> ===</span><span style="color:#FF9E64"> undefined</span><span style="color:#BB9AF7"> ?</span><span style="color:#FF9E64"> 1</span><span style="color:#BB9AF7"> :</span><span style="color:#FF9E64"> 0</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    notes_missing</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">notes</span><span style="color:#BB9AF7"> ===</span><span style="color:#FF9E64"> null</span><span style="color:#BB9AF7"> ||</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">notes</span><span style="color:#BB9AF7"> ===</span><span style="color:#FF9E64"> undefined</span><span style="color:#BB9AF7"> ?</span><span style="color:#FF9E64"> 1</span><span style="color:#BB9AF7"> :</span><span style="color:#FF9E64"> 0</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">summarise</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#7AA2F7">    total_rows</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">df</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> df</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">nrows</span><span style="color:#9ABDF5">()</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    name_missing</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">df</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">sum</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">df</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">name_missing</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    age_missing</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">df</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">sum</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">df</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">age_missing</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    score_missing</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">df</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">sum</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">df</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score_missing</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    active_missing</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">df</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">sum</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">df</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">active_missing</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    notes_missing</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">df</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">sum</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">df</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">notes_missing</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">mutate</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#7AA2F7">    name_missing_pct</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">((</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">name_missing</span><span style="color:#89DDFF"> /</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">total_rows</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF"> *</span><span style="color:#FF9E64"> 100</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 1</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    age_missing_pct</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">((</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">age_missing</span><span style="color:#89DDFF"> /</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">total_rows</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF"> *</span><span style="color:#FF9E64"> 100</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 1</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    score_missing_pct</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">((</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score_missing</span><span style="color:#89DDFF"> /</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">total_rows</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF"> *</span><span style="color:#FF9E64"> 100</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 1</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    active_missing_pct</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">((</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">active_missing</span><span style="color:#89DDFF"> /</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">total_rows</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF"> *</span><span style="color:#FF9E64"> 100</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 1</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    notes_missing_pct</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">((</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">notes_missing</span><span style="color:#89DDFF"> /</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">total_rows</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF"> *</span><span style="color:#FF9E64"> 100</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 1</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C0CAF5">qualityAnalysis</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">print</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">Data quality analysis:</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#51597D;font-style:italic">// Clean the data</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> cleanedData</span><span style="color:#89DDFF"> =</span><span style="color:#C0CAF5"> messyData</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">mutate</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#51597D;font-style:italic">    // Smart replacement using statistics</span></span>
<span class="line"><span style="color:#7AA2F7">    name_cleaned</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">name</span><span style="color:#BB9AF7"> ||</span><span style="color:#89DDFF"> `</span><span style="color:#9ECE6A">Person_</span><span style="color:#7DCFFF">${</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">id</span><span style="color:#7DCFFF">}</span><span style="color:#89DDFF">`</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    age_cleaned</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#9ABDF5"> {</span></span>
<span class="line"><span style="color:#BB9AF7">      if</span><span style="color:#9ABDF5"> (</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">age</span><span style="color:#BB9AF7"> !==</span><span style="color:#FF9E64"> null</span><span style="color:#BB9AF7"> &amp;&amp;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">age</span><span style="color:#BB9AF7"> !==</span><span style="color:#FF9E64"> undefined</span><span style="color:#9ABDF5">) </span><span style="color:#BB9AF7;font-style:italic">return</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">age</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">      return</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">active</span><span style="color:#BB9AF7"> ?</span><span style="color:#FF9E64"> 30</span><span style="color:#BB9AF7"> :</span><span style="color:#FF9E64"> 25</span><span style="color:#89DDFF">;</span><span style="color:#51597D;font-style:italic"> // Different defaults based on other data</span></span>
<span class="line"><span style="color:#9ABDF5">    }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    score_cleaned</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#9ABDF5"> {</span></span>
<span class="line"><span style="color:#BB9AF7">      if</span><span style="color:#9ABDF5"> (</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#BB9AF7"> !==</span><span style="color:#FF9E64"> null</span><span style="color:#BB9AF7"> &amp;&amp;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#BB9AF7"> !==</span><span style="color:#FF9E64"> undefined</span><span style="color:#BB9AF7"> &amp;&amp;</span><span style="color:#BB9AF7"> !</span><span style="color:#7AA2F7">isNaN</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#9ABDF5">)) {</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">        return</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9ABDF5">      }</span></span>
<span class="line"><span style="color:#51597D;font-style:italic">      // Use median for missing scores</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">      const</span><span style="color:#BB9AF7"> validScores</span><span style="color:#89DDFF"> =</span><span style="color:#C0CAF5"> messyData</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">score</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">filter</span><span style="color:#9ABDF5">(</span><span style="color:#E0AF68">x</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> x</span><span style="color:#BB9AF7"> !==</span><span style="color:#FF9E64"> null</span><span style="color:#BB9AF7"> &amp;&amp;</span><span style="color:#C0CAF5"> x</span><span style="color:#BB9AF7"> !==</span><span style="color:#FF9E64"> undefined</span><span style="color:#BB9AF7"> &amp;&amp;</span><span style="color:#BB9AF7"> !</span><span style="color:#7AA2F7">isNaN</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">x</span><span style="color:#9ABDF5">))</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">      return</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">median</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">validScores</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> true</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9ABDF5">    }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    active_cleaned</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">active</span><span style="color:#BB9AF7"> ??</span><span style="color:#FF9E64"> true</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    notes_cleaned</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">notes</span><span style="color:#BB9AF7"> ||</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">No additional notes</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">select</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">id</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">name_cleaned</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">age_cleaned</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">score_cleaned</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">active_cleaned</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">notes_cleaned</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C0CAF5">cleanedData</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">print</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">Cleaned data:</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span></code></pre></div></div></div></div><div data-slot="card" class="bg-card text-card-foreground flex flex-col gap-4 sm:gap-6 rounded-xl border py-4 sm:py-6 shadow-sm min-w-0 overflow-hidden"><div data-slot="card-header" class="@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-3 sm:px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 min-w-0"><div data-slot="card-title" class="leading-none font-semibold min-w-0 break-words">Advanced Joining and Reshaping</div><div data-slot="card-description" class="text-muted-foreground text-sm min-w-0 break-words">Complex data integration and reshaping workflows</div></div><div data-slot="card-content" class="px-3 sm:px-6 min-w-0"><div class="space-y-4"><div><h4 class="font-medium mb-2">Multi-Table Analysis</h4><div class="relative w-full group [&amp;_pre]:!p-4 [&amp;_pre]:!m-0 [&amp;_pre]:!rounded-md [&amp;_pre]:!overflow-x-auto [&amp;_pre]:!text-xs [&amp;_pre]:!font-mono [&amp;_pre]:!bg-[rgb(246,248,250)] dark:[&amp;_pre]:!bg-[rgb(20,20,20)]"><button class="absolute top-2 right-2 p-2 rounded-md bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700 transition-colors opacity-100 z-10 cursor-pointer" aria-label="Copy code"><div class="relative w-4 h-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check h-4 w-4 text-green-600 dark:text-green-400 transition-all duration-200 opacity-0 scale-75 absolute inset-0"><path d="M20 6 9 17l-5-5"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-4 w-4 text-gray-600 dark:text-gray-400 transition-all duration-200 opacity-100 scale-100 absolute inset-0"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></div></button><div class="[&amp;&gt;pre.shiki:first-child]:block [&amp;&gt;pre.shiki:last-child]:hidden dark:[&amp;&gt;pre.shiki:first-child]:hidden dark:[&amp;&gt;pre.shiki:last-child]:block"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#6A737D">// Employee and department data</span></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> employees</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> createDataFrame</span><span style="color:#24292E">([</span></span>
<span class="line"><span style="color:#24292E">  { emp_id: </span><span style="color:#005CC5">1</span><span style="color:#24292E">, name: </span><span style="color:#032F62">"Alice"</span><span style="color:#24292E">, dept_id: </span><span style="color:#005CC5">10</span><span style="color:#24292E">, year: </span><span style="color:#005CC5">2023</span><span style="color:#24292E">, salary: </span><span style="color:#005CC5">50000</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { emp_id: </span><span style="color:#005CC5">2</span><span style="color:#24292E">, name: </span><span style="color:#032F62">"Bob"</span><span style="color:#24292E">, dept_id: </span><span style="color:#005CC5">20</span><span style="color:#24292E">, year: </span><span style="color:#005CC5">2023</span><span style="color:#24292E">, salary: </span><span style="color:#005CC5">60000</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { emp_id: </span><span style="color:#005CC5">3</span><span style="color:#24292E">, name: </span><span style="color:#032F62">"Charlie"</span><span style="color:#24292E">, dept_id: </span><span style="color:#005CC5">10</span><span style="color:#24292E">, year: </span><span style="color:#005CC5">2024</span><span style="color:#24292E">, salary: </span><span style="color:#005CC5">55000</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { emp_id: </span><span style="color:#005CC5">4</span><span style="color:#24292E">, name: </span><span style="color:#032F62">"Diana"</span><span style="color:#24292E">, dept_id: </span><span style="color:#005CC5">30</span><span style="color:#24292E">, year: </span><span style="color:#005CC5">2023</span><span style="color:#24292E">, salary: </span><span style="color:#005CC5">70000</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> departments</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> createDataFrame</span><span style="color:#24292E">([</span></span>
<span class="line"><span style="color:#24292E">  { dept_id: </span><span style="color:#005CC5">10</span><span style="color:#24292E">, year: </span><span style="color:#005CC5">2023</span><span style="color:#24292E">, dept_name: </span><span style="color:#032F62">"Engineering"</span><span style="color:#24292E">, manager: </span><span style="color:#032F62">"John"</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { dept_id: </span><span style="color:#005CC5">20</span><span style="color:#24292E">, year: </span><span style="color:#005CC5">2023</span><span style="color:#24292E">, dept_name: </span><span style="color:#032F62">"Marketing"</span><span style="color:#24292E">, manager: </span><span style="color:#032F62">"Jane"</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { dept_id: </span><span style="color:#005CC5">10</span><span style="color:#24292E">, year: </span><span style="color:#005CC5">2024</span><span style="color:#24292E">, dept_name: </span><span style="color:#032F62">"Engineering"</span><span style="color:#24292E">, manager: </span><span style="color:#032F62">"Sarah"</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// Multi-key join and analysis</span></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> departmentAnalysis</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> employees</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">innerJoin</span><span style="color:#24292E">(departments, [</span><span style="color:#032F62">"dept_id"</span><span style="color:#24292E">, </span><span style="color:#032F62">"year"</span><span style="color:#24292E">])</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">mutate</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6F42C1">    salary_rank</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">, </span><span style="color:#E36209">_index</span><span style="color:#24292E">, </span><span style="color:#E36209">df</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">rank</span><span style="color:#24292E">(df.salary, row.salary),</span></span>
<span class="line"><span style="color:#6F42C1">    salary_percentile</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">, </span><span style="color:#E36209">_index</span><span style="color:#24292E">, </span><span style="color:#E36209">df</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">percentileRank</span><span style="color:#24292E">(df.salary, row.salary),</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">groupBy</span><span style="color:#24292E">(</span><span style="color:#032F62">"dept_name"</span><span style="color:#24292E">)</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">summarise</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6F42C1">    employee_count</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> group.</span><span style="color:#6F42C1">nrows</span><span style="color:#24292E">(),</span></span>
<span class="line"><span style="color:#6F42C1">    avg_salary</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">(s.</span><span style="color:#6F42C1">mean</span><span style="color:#24292E">(group.salary), </span><span style="color:#005CC5">0</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#6F42C1">    median_salary</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">median</span><span style="color:#24292E">(group.salary),</span></span>
<span class="line"><span style="color:#6F42C1">    salary_range</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#032F62"> `${</span><span style="color:#24292E">s</span><span style="color:#032F62">.</span><span style="color:#6F42C1">min</span><span style="color:#032F62">(</span><span style="color:#24292E">group</span><span style="color:#032F62">.</span><span style="color:#24292E">salary</span><span style="color:#032F62">)</span><span style="color:#032F62">}-${</span><span style="color:#24292E">s</span><span style="color:#032F62">.</span><span style="color:#6F42C1">max</span><span style="color:#032F62">(</span><span style="color:#24292E">group</span><span style="color:#032F62">.</span><span style="color:#24292E">salary</span><span style="color:#032F62">)</span><span style="color:#032F62">}`</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">    top_earner</span><span style="color:#24292E">: (</span><span style="color:#E36209">group</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      const</span><span style="color:#005CC5"> maxSalary</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">max</span><span style="color:#24292E">(group.salary);</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#24292E"> group.</span><span style="color:#6F42C1">find</span><span style="color:#24292E">(</span><span style="color:#E36209">row</span><span style="color:#D73A49"> =&gt;</span><span style="color:#24292E"> row.salary </span><span style="color:#D73A49">===</span><span style="color:#24292E"> maxSalary)?.name </span><span style="color:#D73A49">||</span><span style="color:#032F62"> "N/A"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">    },</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">arrange</span><span style="color:#24292E">(</span><span style="color:#032F62">"avg_salary"</span><span style="color:#24292E">, </span><span style="color:#032F62">"desc"</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">departmentAnalysis.</span><span style="color:#6F42C1">print</span><span style="color:#24292E">(</span><span style="color:#032F62">"Department analysis:"</span><span style="color:#24292E">);</span></span></code></pre><pre class="shiki tokyo-night" style="background-color:#1a1b26;color:#a9b1d6" tabindex="0"><code><span class="line"><span style="color:#51597D;font-style:italic">// Employee and department data</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> employees</span><span style="color:#89DDFF"> =</span><span style="color:#7AA2F7"> createDataFrame</span><span style="color:#9ABDF5">([</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> emp_id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Alice</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> dept_id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 10</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2023</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> salary</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 50000</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> emp_id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Bob</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> dept_id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 20</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2023</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> salary</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 60000</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> emp_id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 3</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Charlie</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> dept_id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 10</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2024</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> salary</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 55000</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> emp_id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 4</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Diana</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> dept_id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 30</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2023</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> salary</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 70000</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">])</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> departments</span><span style="color:#89DDFF"> =</span><span style="color:#7AA2F7"> createDataFrame</span><span style="color:#9ABDF5">([</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> dept_id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 10</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2023</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> dept_name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Engineering</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> manager</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">John</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> dept_id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 20</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2023</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> dept_name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Marketing</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> manager</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Jane</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> dept_id</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 10</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2024</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> dept_name</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Engineering</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> manager</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Sarah</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">])</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#51597D;font-style:italic">// Multi-key join and analysis</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> departmentAnalysis</span><span style="color:#89DDFF"> =</span><span style="color:#C0CAF5"> employees</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">innerJoin</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">departments</span><span style="color:#89DDFF">,</span><span style="color:#9ABDF5"> [</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">dept_id</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">year</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">])</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">mutate</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#7AA2F7">    salary_rank</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#89DDFF">,</span><span style="color:#E0AF68"> _index</span><span style="color:#89DDFF">,</span><span style="color:#E0AF68"> df</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">rank</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">df</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">salary</span><span style="color:#89DDFF">,</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">salary</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    salary_percentile</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#89DDFF">,</span><span style="color:#E0AF68"> _index</span><span style="color:#89DDFF">,</span><span style="color:#E0AF68"> df</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">percentileRank</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">df</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">salary</span><span style="color:#89DDFF">,</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">salary</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">groupBy</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">dept_name</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">summarise</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#7AA2F7">    employee_count</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> group</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">nrows</span><span style="color:#9ABDF5">()</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    avg_salary</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">mean</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">salary</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 0</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    median_salary</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">median</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">salary</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    salary_range</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#89DDFF"> `</span><span style="color:#7DCFFF">${</span><span style="color:#C0CAF5">s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">min</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">salary</span><span style="color:#9ABDF5">)</span><span style="color:#7DCFFF">}</span><span style="color:#9ECE6A">-</span><span style="color:#7DCFFF">${</span><span style="color:#C0CAF5">s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">max</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">salary</span><span style="color:#9ABDF5">)</span><span style="color:#7DCFFF">}</span><span style="color:#89DDFF">`</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    top_earner</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">group</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#9ABDF5"> {</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">      const</span><span style="color:#BB9AF7"> maxSalary</span><span style="color:#89DDFF"> =</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">max</span><span style="color:#9ABDF5">(</span><span style="color:#C0CAF5">group</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">salary</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">      return</span><span style="color:#C0CAF5"> group</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">find</span><span style="color:#9ABDF5">(</span><span style="color:#E0AF68">row</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">salary</span><span style="color:#BB9AF7"> ===</span><span style="color:#C0CAF5"> maxSalary</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">?.</span><span style="color:#7DCFFF">name</span><span style="color:#BB9AF7"> ||</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">N/A</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9ABDF5">    }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">arrange</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">avg_salary</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">desc</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C0CAF5">departmentAnalysis</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">print</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">Department analysis:</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span></code></pre></div></div></div><div><h4 class="font-medium mb-2">Data Reshaping and Pivoting</h4><div class="relative w-full group [&amp;_pre]:!p-4 [&amp;_pre]:!m-0 [&amp;_pre]:!rounded-md [&amp;_pre]:!overflow-x-auto [&amp;_pre]:!text-xs [&amp;_pre]:!font-mono [&amp;_pre]:!bg-[rgb(246,248,250)] dark:[&amp;_pre]:!bg-[rgb(20,20,20)]"><button class="absolute top-2 right-2 p-2 rounded-md bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700 transition-colors opacity-100 z-10 cursor-pointer" aria-label="Copy code"><div class="relative w-4 h-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check h-4 w-4 text-green-600 dark:text-green-400 transition-all duration-200 opacity-0 scale-75 absolute inset-0"><path d="M20 6 9 17l-5-5"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-4 w-4 text-gray-600 dark:text-gray-400 transition-all duration-200 opacity-100 scale-100 absolute inset-0"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></div></button><div class="[&amp;&gt;pre.shiki:first-child]:block [&amp;&gt;pre.shiki:last-child]:hidden dark:[&amp;&gt;pre.shiki:first-child]:hidden dark:[&amp;&gt;pre.shiki:last-child]:block"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#6A737D">// Sales data in long format</span></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> salesLong</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> createDataFrame</span><span style="color:#24292E">([</span></span>
<span class="line"><span style="color:#24292E">  { year: </span><span style="color:#005CC5">2023</span><span style="color:#24292E">, quarter: </span><span style="color:#032F62">"Q1"</span><span style="color:#24292E">, product: </span><span style="color:#032F62">"Widget A"</span><span style="color:#24292E">, sales: </span><span style="color:#005CC5">1000</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { year: </span><span style="color:#005CC5">2023</span><span style="color:#24292E">, quarter: </span><span style="color:#032F62">"Q1"</span><span style="color:#24292E">, product: </span><span style="color:#032F62">"Widget B"</span><span style="color:#24292E">, sales: </span><span style="color:#005CC5">1500</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { year: </span><span style="color:#005CC5">2023</span><span style="color:#24292E">, quarter: </span><span style="color:#032F62">"Q2"</span><span style="color:#24292E">, product: </span><span style="color:#032F62">"Widget A"</span><span style="color:#24292E">, sales: </span><span style="color:#005CC5">1200</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { year: </span><span style="color:#005CC5">2023</span><span style="color:#24292E">, quarter: </span><span style="color:#032F62">"Q2"</span><span style="color:#24292E">, product: </span><span style="color:#032F62">"Widget B"</span><span style="color:#24292E">, sales: </span><span style="color:#005CC5">1800</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { year: </span><span style="color:#005CC5">2024</span><span style="color:#24292E">, quarter: </span><span style="color:#032F62">"Q1"</span><span style="color:#24292E">, product: </span><span style="color:#032F62">"Widget A"</span><span style="color:#24292E">, sales: </span><span style="color:#005CC5">1100</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">  { year: </span><span style="color:#005CC5">2024</span><span style="color:#24292E">, quarter: </span><span style="color:#032F62">"Q1"</span><span style="color:#24292E">, product: </span><span style="color:#032F62">"Widget B"</span><span style="color:#24292E">, sales: </span><span style="color:#005CC5">1600</span><span style="color:#24292E"> },</span></span>
<span class="line"><span style="color:#24292E">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// Pivot to wide format and analyze</span></span>
<span class="line"><span style="color:#D73A49">const</span><span style="color:#005CC5"> pivotAnalysis</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> salesLong</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">pivotWider</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#24292E">    names_from: </span><span style="color:#032F62">"product"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    values_from: </span><span style="color:#032F62">"sales"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    expected_columns: [</span><span style="color:#032F62">"Widget A"</span><span style="color:#24292E">, </span><span style="color:#032F62">"Widget B"</span><span style="color:#24292E">],</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">mutate</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#6F42C1">    total_sales</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> row[</span><span style="color:#032F62">"Widget A"</span><span style="color:#24292E">] </span><span style="color:#D73A49">+</span><span style="color:#24292E"> row[</span><span style="color:#032F62">"Widget B"</span><span style="color:#24292E">],</span></span>
<span class="line"><span style="color:#6F42C1">    widget_a_share</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">((row[</span><span style="color:#032F62">"Widget A"</span><span style="color:#24292E">] </span><span style="color:#D73A49">/</span><span style="color:#24292E"> row.total_sales) </span><span style="color:#D73A49">*</span><span style="color:#005CC5"> 100</span><span style="color:#24292E">, </span><span style="color:#005CC5">1</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#6F42C1">    widget_b_share</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">((row[</span><span style="color:#032F62">"Widget B"</span><span style="color:#24292E">] </span><span style="color:#D73A49">/</span><span style="color:#24292E"> row.total_sales) </span><span style="color:#D73A49">*</span><span style="color:#005CC5"> 100</span><span style="color:#24292E">, </span><span style="color:#005CC5">1</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#6F42C1">    growth_rate</span><span style="color:#24292E">: (</span><span style="color:#E36209">row</span><span style="color:#24292E">, </span><span style="color:#E36209">index</span><span style="color:#24292E">, </span><span style="color:#E36209">df</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">      if</span><span style="color:#24292E"> (index </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">) </span><span style="color:#D73A49">return</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">      const</span><span style="color:#005CC5"> prevRow</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> df[index </span><span style="color:#D73A49">-</span><span style="color:#005CC5"> 1</span><span style="color:#24292E">];</span></span>
<span class="line"><span style="color:#D73A49">      return</span><span style="color:#24292E"> s.</span><span style="color:#6F42C1">round</span><span style="color:#24292E">(((row.total_sales </span><span style="color:#D73A49">-</span><span style="color:#24292E"> prevRow.total_sales) </span><span style="color:#D73A49">/</span><span style="color:#24292E"> prevRow.total_sales) </span><span style="color:#D73A49">*</span><span style="color:#005CC5"> 100</span><span style="color:#24292E">, </span><span style="color:#005CC5">1</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    },</span></span>
<span class="line"><span style="color:#24292E">  })</span></span>
<span class="line"><span style="color:#24292E">  .</span><span style="color:#6F42C1">arrange</span><span style="color:#24292E">(</span><span style="color:#032F62">"year"</span><span style="color:#24292E">, </span><span style="color:#032F62">"quarter"</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">pivotAnalysis.</span><span style="color:#6F42C1">print</span><span style="color:#24292E">(</span><span style="color:#032F62">"Pivot analysis with market share:"</span><span style="color:#24292E">);</span></span></code></pre><pre class="shiki tokyo-night" style="background-color:#1a1b26;color:#a9b1d6" tabindex="0"><code><span class="line"><span style="color:#51597D;font-style:italic">// Sales data in long format</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> salesLong</span><span style="color:#89DDFF"> =</span><span style="color:#7AA2F7"> createDataFrame</span><span style="color:#9ABDF5">([</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2023</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> quarter</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Q1</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> product</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Widget A</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> sales</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1000</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2023</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> quarter</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Q1</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> product</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Widget B</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> sales</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1500</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2023</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> quarter</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Q2</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> product</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Widget A</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> sales</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1200</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2023</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> quarter</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Q2</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> product</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Widget B</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> sales</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1800</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2024</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> quarter</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Q1</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> product</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Widget A</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> sales</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1100</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  {</span><span style="color:#73DACA"> year</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 2024</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> quarter</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Q1</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> product</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Widget B</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#73DACA"> sales</span><span style="color:#89DDFF">:</span><span style="color:#FF9E64"> 1600</span><span style="color:#9ABDF5"> }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">])</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#51597D;font-style:italic">// Pivot to wide format and analyze</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">const</span><span style="color:#BB9AF7"> pivotAnalysis</span><span style="color:#89DDFF"> =</span><span style="color:#C0CAF5"> salesLong</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">pivotWider</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#73DACA">    names_from</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">product</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#73DACA">    values_from</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">sales</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#73DACA">    expected_columns</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> [</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">Widget A</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">Widget B</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">]</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">mutate</span><span style="color:#9ABDF5">({</span></span>
<span class="line"><span style="color:#7AA2F7">    total_sales</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> row</span><span style="color:#9ABDF5">[</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">Widget A</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">]</span><span style="color:#89DDFF"> +</span><span style="color:#C0CAF5"> row</span><span style="color:#9ABDF5">[</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">Widget B</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">]</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    widget_a_share</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">((</span><span style="color:#C0CAF5">row</span><span style="color:#9ABDF5">[</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">Widget A</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">]</span><span style="color:#89DDFF"> /</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">total_sales</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF"> *</span><span style="color:#FF9E64"> 100</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 1</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    widget_b_share</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">((</span><span style="color:#C0CAF5">row</span><span style="color:#9ABDF5">[</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">Widget B</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">]</span><span style="color:#89DDFF"> /</span><span style="color:#C0CAF5"> row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">total_sales</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF"> *</span><span style="color:#FF9E64"> 100</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 1</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#7AA2F7">    growth_rate</span><span style="color:#89DDFF">:</span><span style="color:#9ABDF5"> (</span><span style="color:#E0AF68">row</span><span style="color:#89DDFF">,</span><span style="color:#E0AF68"> index</span><span style="color:#89DDFF">,</span><span style="color:#E0AF68"> df</span><span style="color:#9ABDF5">)</span><span style="color:#BB9AF7"> =&gt;</span><span style="color:#9ABDF5"> {</span></span>
<span class="line"><span style="color:#BB9AF7">      if</span><span style="color:#9ABDF5"> (</span><span style="color:#C0CAF5">index</span><span style="color:#BB9AF7"> ===</span><span style="color:#FF9E64"> 0</span><span style="color:#9ABDF5">) </span><span style="color:#BB9AF7;font-style:italic">return</span><span style="color:#FF9E64"> 0</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9D7CD8;font-style:italic">      const</span><span style="color:#BB9AF7"> prevRow</span><span style="color:#89DDFF"> =</span><span style="color:#C0CAF5"> df</span><span style="color:#9ABDF5">[</span><span style="color:#7DCFFF">index</span><span style="color:#89DDFF"> -</span><span style="color:#FF9E64"> 1</span><span style="color:#9ABDF5">]</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BB9AF7;font-style:italic">      return</span><span style="color:#C0CAF5"> s</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">round</span><span style="color:#9ABDF5">(((</span><span style="color:#C0CAF5">row</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">total_sales</span><span style="color:#89DDFF"> -</span><span style="color:#C0CAF5"> prevRow</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">total_sales</span><span style="color:#9ABDF5">) </span><span style="color:#89DDFF">/</span><span style="color:#C0CAF5"> prevRow</span><span style="color:#89DDFF">.</span><span style="color:#7DCFFF">total_sales</span><span style="color:#9ABDF5">) </span><span style="color:#89DDFF">*</span><span style="color:#FF9E64"> 100</span><span style="color:#89DDFF">,</span><span style="color:#FF9E64"> 1</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#9ABDF5">    }</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#9ABDF5">  })</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#7AA2F7">arrange</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">year</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#9ECE6A">quarter</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C0CAF5">pivotAnalysis</span><span style="color:#89DDFF">.</span><span style="color:#7AA2F7">print</span><span style="color:#9ABDF5">(</span><span style="color:#89DDFF">"</span><span style="color:#9ECE6A">Pivot analysis with market share:</span><span style="color:#89DDFF">"</span><span style="color:#9ABDF5">)</span><span style="color:#89DDFF">;</span></span></code></pre></div></div></div></div></div></div></div></div><div><footer class="TanStackRouterDevtools" style="--tsrd-font-size: 16px;"><div class="go1688509379 TanStackRouterDevtoolsPanel go905199096 go1639696032 go3383159955 go844172998" style="height: 500px;"><div class="go1505018836"></div><button class="go2224423957"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="6" fill="none" viewBox="0 0 10 6" class="go959131266"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.667" d="M1 1l4 4 4-4"></path></svg></button><div class="go1468579934"><div class="go1648261519"><button aria-hidden="true" class="go283257069"><div class="go151905477">TANSTACK</div><div class="go2259959382">TanStack Router v1</div></button></div><div class="go3747950898"><div class="go2041761433"><div class="go898539426"><button class="go1058205856"><span class="go2272256769"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" class="go3879208559"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"></path></svg></span>Router<span class="go2916152260">12 items</span></button><div class="go1244333964"><div class="go898539426"><button class="go1058205856"><span class="go2272256769"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" class="go3879208559"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"></path></svg></span>state<span class="go2916152260">10 items</span></button><div class="go1244333964"><div class="go898539426"><span>loadedAt:</span> <span class="go1863549978">1758953713911</span></div><div class="go898539426"><span>isLoading:</span> <span class="go1863549978">false</span></div><div class="go898539426"><span>isTransitioning:</span> <span class="go1863549978">false</span></div><div class="go898539426"><span>status:</span> <span class="go1863549978">"idle"</span></div><div class="go898539426"><button class="go1058205856"><span class="go2272256769"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" class="go1560190766"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"></path></svg></span>resolvedLocation<span class="go2916152260">6 items</span></button></div><div class="go898539426"><button class="go1058205856"><span class="go2272256769"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" class="go1560190766"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"></path></svg></span>location<span class="go2916152260">6 items</span></button></div><div class="go898539426"><button class="go1058205856"><span class="go2272256769"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" class="go1560190766"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"></path></svg></span>matches<span class="go2916152260">2 items</span></button></div><div class="go898539426"><span>pendingMatches:</span> <span class="go1863549978"></span></div><div class="go898539426"><span>cachedMatches:</span> <span class="go1863549978">[]</span></div><div class="go898539426"><span>statusCode:</span> <span class="go1863549978">200</span></div></div></div><div class="go898539426"><button class="go1058205856"><span class="go2272256769"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" class="go1560190766"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"></path></svg></span>routesById<span class="go2916152260">22 items</span></button></div><div class="go898539426"><button class="go1058205856"><span class="go2272256769"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" class="go1560190766"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"></path></svg></span>routesByPath<span class="go2916152260">21 items</span></button></div><div class="go898539426"><button class="go1058205856"><span class="go2272256769"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" class="go1560190766"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"></path></svg></span>flatRoutes<span class="go2916152260">21 items</span></button></div><div class="go898539426"><button class="go1058205856"><span class="go2272256769"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" class="go3879208559"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"></path></svg></span>options<span class="go2916152260">8 items</span></button><div class="go1244333964"><div class="go898539426"><span>defaultPreloadDelay:</span> <span class="go1863549978">50</span></div><div class="go898539426"><span>defaultPendingMs:</span> <span class="go1863549978">1000</span></div><div class="go898539426"><span>defaultPendingMinMs:</span> <span class="go1863549978">500</span></div><div class="go898539426"><button class="go1058205856"><span class="go2272256769"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" class="go1560190766"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"></path></svg></span>context<span class="go2916152260">1 item</span></button></div><div class="go898539426"><button class="go1058205856"><span class="go2272256769"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" class="go1560190766"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18l6-6-6-6"></path></svg></span>routeTree<span class="go2916152260">11 items</span></button></div><div class="go898539426"><span>basepath:</span> <span class="go1863549978">"/tidy-ts"</span></div><div class="go898539426"><span>caseSensitive:</span> <span class="go1863549978">false</span></div><div class="go898539426"><span>notFoundMode:</span> <span class="go1863549978">"fuzzy"</span></div></div></div><div class="go898539426"><span>isViewTransitionTypesSupported:</span> <span class="go1863549978">true</span></div><div class="go898539426"><span>isScrollRestoring:</span> <span class="go1863549978">false</span></div><div class="go898539426"><span>isScrollRestorationSetup:</span> <span class="go1863549978">true</span></div><div class="go898539426"><span>parsePathnameCache:</span> <span class="go1863549978">{}</span></div><div class="go898539426"><span>isServer:</span> <span class="go1863549978">false</span></div><div class="go898539426"><span>pathParamsDecodeCharMap:</span> <span class="go1863549978"></span></div><div class="go898539426"><span>commitLocationPromise:</span> <span class="go1863549978"></span></div></div></div></div></div></div><div class="go1468579934"><div class="go1560856704"><div class="go2273422943"><span>Pathname</span></div><div class="go3889393570"><code>/tidy-ts/examples/comprehensive-workflows</code></div><div class="go2273422943"><div class="go3620606704"><button type="button" class="go3643664686 go862916629 go1232428028">Routes</button><button type="button" class="go3643664686 go2107851696" disabled="">Matches</button></div><div class="go3993070631"><div>age / staleTime / gcTime</div></div></div><div class="go427126709"><div><div role="button" aria-label="Open match details for __root__" class="go3752837924"><div class="go4274307370"></div><div style="display: flex; align-items: center; width: 100%;"><button type="button" title="Navigate to /tidy-ts/" class="go1702243790">➔</button><div style="flex-grow: 1; min-width: 0px;"><code class="go1957354353">__root__</code></div></div></div><div role="button" aria-label="Open match details for /examples/comprehensive-workflows" class="go3752837924"><div class="go4274307370"></div><div style="display: flex; align-items: center; width: 100%;"><button type="button" title="Navigate to /tidy-ts/examples/comprehensive-workflows" class="go1702243790">➔</button><div style="flex-grow: 1; min-width: 0px;"><code class="go1957354353">/tidy-ts/examples/comprehensive-workflows</code></div></div></div></div></div></div></div></div><button type="button" aria-label="Open TanStack Router Devtools" class="go1767807125 go2902208695 go2279492678"><div class="go1460193506"><div class="go2552515089"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 634 633" viewBox="0 0 634 633"><g transform="translate(1)"><linearGradient x1="-641.486" x2="-641.486" y1="856.648" y2="855.931" gradientTransform="matrix(633 0 0 -633 406377 542258)" gradientUnits="userSpaceOnUse" id="a-cl-0"><stop offset="0" stop-color="#6bdaff"></stop><stop offset="0.319" stop-color="#f9ffb5"></stop><stop offset="0.706" stop-color="#ffa770"></stop><stop offset="1" stop-color="#ff7373"></stop></linearGradient><circle cx="316.5" cy="316.5" r="316.5" fill-rule="evenodd" clip-rule="evenodd" fill="url(#a-cl-0)"></circle><defs><filter width="454" height="396.9" x="-137.5" y="412" filterUnits="userSpaceOnUse" id="b-cl-0"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="-137.5" y="412" maskUnits="userSpaceOnUse" id="c-cl-0"><g filter="url(#b-cl-0)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="89.5" cy="610.5" fill="#015064" fill-rule="evenodd" stroke="#00CFE2" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#c-cl-0)"></ellipse><defs><filter width="454" height="396.9" x="316.5" y="412" filterUnits="userSpaceOnUse" id="d-cl-0"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="316.5" y="412" maskUnits="userSpaceOnUse" id="e-cl-0"><g filter="url(#d-cl-0)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="543.5" cy="610.5" fill="#015064" fill-rule="evenodd" stroke="#00CFE2" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#e-cl-0)"></ellipse><defs><filter width="454" height="396.9" x="-137.5" y="450" filterUnits="userSpaceOnUse" id="f-cl-0"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="-137.5" y="450" maskUnits="userSpaceOnUse" id="g-cl-0"><g filter="url(#f-cl-0)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="89.5" cy="648.5" fill="#015064" fill-rule="evenodd" stroke="#00A8B8" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#g-cl-0)"></ellipse><defs><filter width="454" height="396.9" x="316.5" y="450" filterUnits="userSpaceOnUse" id="h-cl-0"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="316.5" y="450" maskUnits="userSpaceOnUse" id="i-cl-0"><g filter="url(#h-cl-0)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="543.5" cy="648.5" fill="#015064" fill-rule="evenodd" stroke="#00A8B8" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#i-cl-0)"></ellipse><defs><filter width="454" height="396.9" x="-137.5" y="486" filterUnits="userSpaceOnUse" id="j-cl-0"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="-137.5" y="486" maskUnits="userSpaceOnUse" id="k-cl-0"><g filter="url(#j-cl-0)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="89.5" cy="684.5" fill="#015064" fill-rule="evenodd" stroke="#007782" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#k-cl-0)"></ellipse><defs><filter width="454" height="396.9" x="316.5" y="486" filterUnits="userSpaceOnUse" id="l-cl-0"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="316.5" y="486" maskUnits="userSpaceOnUse" id="m-cl-0"><g filter="url(#l-cl-0)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="543.5" cy="684.5" fill="#015064" fill-rule="evenodd" stroke="#007782" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#m-cl-0)"></ellipse><defs><filter width="176.9" height="129.3" x="272.2" y="308" filterUnits="userSpaceOnUse" id="n-cl-0"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="176.9" height="129.3" x="272.2" y="308" maskUnits="userSpaceOnUse" id="o-cl-0"><g filter="url(#n-cl-0)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><g mask="url(#o-cl-0)"><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="11" d="M436 403.2l-5 28.6m-140-90.3l-10.9 62m52.8-19.4l-4.3 27.1"></path><linearGradient x1="-645.656" x2="-646.499" y1="854.878" y2="854.788" gradientTransform="matrix(-184.159 -32.4722 11.4608 -64.9973 -128419.844 34938.836)" gradientUnits="userSpaceOnUse" id="p-cl-0"><stop offset="0" stop-color="#ee2700"></stop><stop offset="1" stop-color="#ff008e"></stop></linearGradient><path fill-rule="evenodd" d="M344.1 363l97.7 17.2c5.8 2.1 8.2 6.2 7.1 12.1-1 5.9-4.7 9.2-11 9.9l-106-18.7-57.5-59.2c-3.2-4.8-2.9-9.1.8-12.8 3.7-3.7 8.3-4.4 13.7-2.1l55.2 53.6z" clip-rule="evenodd" fill="url(#p-cl-0)"></path><path fill="#D8D8D8" fill-rule="evenodd" stroke="#FFF" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="7" d="M428.3 384.5l.9-6.5m-33.9 1.5l.9-6.5m-34 .5l.9-6.1m-38.9-16.1l4.2-3.9m-25.2-16.1l4.2-3.9" clip-rule="evenodd"></path></g><defs><filter width="280.6" height="317.4" x="73.2" y="113.9" filterUnits="userSpaceOnUse" id="q-cl-0"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="280.6" height="317.4" x="73.2" y="113.9" maskUnits="userSpaceOnUse" id="r-cl-0"><g filter="url(#q-cl-0)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><g mask="url(#r-cl-0)"><linearGradient x1="-646.8" x2="-646.8" y1="854.844" y2="853.844" gradientTransform="matrix(-100.1751 48.8587 -97.9753 -200.879 19124.773 203538.61)" gradientUnits="userSpaceOnUse" id="s-cl-0"><stop offset="0" stop-color="#a17500"></stop><stop offset="1" stop-color="#5d2100"></stop></linearGradient><path fill-rule="evenodd" d="M192.3 203c8.1 37.3 14 73.6 17.8 109.1 3.8 35.4 2.8 75.2-2.9 119.2l61.2-16.7c-15.6-59-25.2-97.9-28.6-116.6-3.4-18.7-10.8-51.8-22.2-99.6l-25.3 4.6" clip-rule="evenodd" fill="url(#s-cl-0)"></path><linearGradient x1="-635.467" x2="-635.467" y1="852.115" y2="851.115" gradientTransform="matrix(92.6873 4.8575 2.0257 -38.6535 57323.695 36176.047)" gradientUnits="userSpaceOnUse" id="t-cl-0"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M195 183.9s-12.6-22.1-36.5-29.9c-15.9-5.2-34.4-1.5-55.5 11.1 15.9 14.3 29.5 22.6 40.7 24.9 16.8 3.6 51.3-6.1 51.3-6.1z" clip-rule="evenodd" fill="url(#t-cl-0)"></path><linearGradient x1="-636.573" x2="-636.573" y1="855.444" y2="854.444" gradientTransform="matrix(109.9945 5.7646 6.3597 -121.3507 64719.133 107659.336)" gradientUnits="userSpaceOnUse" id="u-cl-0"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M194.9 184.5s-47.5-8.5-83.2 15.7c-23.8 16.2-34.3 49.3-31.6 99.3 30.3-27.8 52.1-48.5 65.2-61.9 19.8-20 49.6-53.1 49.6-53.1z" clip-rule="evenodd" fill="url(#u-cl-0)"></path><linearGradient x1="-632.145" x2="-632.145" y1="854.174" y2="853.174" gradientTransform="matrix(62.9558 3.2994 3.5021 -66.8246 37035.367 59284.227)" gradientUnits="userSpaceOnUse" id="v-cl-0"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M195 183.9c-.8-21.9 6-38 20.6-48.2 14.6-10.2 29.8-15.3 45.5-15.3-6.1 21.4-14.5 35.8-25.2 43.4-10.7 7.5-24.4 14.2-40.9 20.1z" clip-rule="evenodd" fill="url(#v-cl-0)"></path><linearGradient x1="-638.224" x2="-638.224" y1="853.801" y2="852.801" gradientTransform="matrix(152.4666 7.9904 3.0934 -59.0251 94939.86 55646.855)" gradientUnits="userSpaceOnUse" id="w-cl-0"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M194.9 184.5c31.9-30 64.1-39.7 96.7-29 32.6 10.7 50.8 30.4 54.6 59.1-35.2-5.5-60.4-9.6-75.8-12.1-15.3-2.6-40.5-8.6-75.5-18z" clip-rule="evenodd" fill="url(#w-cl-0)"></path><linearGradient x1="-637.723" x2="-637.723" y1="855.103" y2="854.103" gradientTransform="matrix(136.467 7.1519 5.2165 -99.5377 82830.875 89859.578)" gradientUnits="userSpaceOnUse" id="x-cl-0"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M194.9 184.5c35.8-7.6 65.6-.2 89.2 22 23.6 22.2 37.7 49 42.3 80.3-39.8-9.7-68.3-23.8-85.5-42.4-17.2-18.5-32.5-38.5-46-59.9z" clip-rule="evenodd" fill="url(#x-cl-0)"></path><linearGradient x1="-631.79" x2="-631.79" y1="855.872" y2="854.872" gradientTransform="matrix(60.8683 3.19 8.7771 -167.4773 31110.818 145537.61)" gradientUnits="userSpaceOnUse" id="y-cl-0"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M194.9 184.5c-33.6 13.8-53.6 35.7-60.1 65.6-6.5 29.9-3.6 63.1 8.7 99.6 27.4-40.3 43.2-69.6 47.4-88 4.2-18.3 5.5-44.1 4-77.2z" clip-rule="evenodd" fill="url(#y-cl-0)"></path><path fill="none" stroke="#2F8A00" stroke-linecap="round" stroke-width="8" d="M196.5 182.3c-14.8 21.6-25.1 41.4-30.8 59.4-5.7 18-9.4 33-11.1 45.1"></path><path fill="none" stroke="#2F8A00" stroke-linecap="round" stroke-width="8" d="M194.8 185.7c-24.4 1.7-43.8 9-58.1 21.8-14.3 12.8-24.7 25.4-31.3 37.8m99.1-68.9c29.7-6.7 52-8.4 67-5 15 3.4 26.9 8.7 35.8 15.9m-110.8-5.9c20.3 9.9 38.2 20.5 53.9 31.9 15.7 11.4 27.4 22.1 35.1 32"></path></g><defs><filter width="532" height="633" x="50.5" y="399" filterUnits="userSpaceOnUse" id="z-cl-0"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="532" height="633" x="50.5" y="399" maskUnits="userSpaceOnUse" id="A-cl-0"><g filter="url(#z-cl-0)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><linearGradient x1="-641.104" x2="-641.278" y1="856.577" y2="856.183" gradientTransform="matrix(532 0 0 -633 341484.5 542657)" gradientUnits="userSpaceOnUse" id="B-cl-0"><stop offset="0" stop-color="#fff400"></stop><stop offset="1" stop-color="#3c8700"></stop></linearGradient><ellipse cx="316.5" cy="715.5" fill-rule="evenodd" clip-rule="evenodd" rx="266" ry="316.5" fill="url(#B-cl-0)" mask="url(#A-cl-0)"></ellipse><defs><filter width="288" height="283" x="391" y="-24" filterUnits="userSpaceOnUse" id="C-cl-0"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="288" height="283" x="391" y="-24" maskUnits="userSpaceOnUse" id="D-cl-0"><g filter="url(#C-cl-0)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><g mask="url(#D-cl-0)"><g transform="translate(397 -24)"><linearGradient x1="-1036.672" x2="-1036.672" y1="880.018" y2="879.018" gradientTransform="matrix(227 0 0 -227 235493 199764)" gradientUnits="userSpaceOnUse" id="E-cl-0"><stop offset="0" stop-color="#ffdf00"></stop><stop offset="1" stop-color="#ff9d00"></stop></linearGradient><circle cx="168.5" cy="113.5" r="113.5" fill-rule="evenodd" clip-rule="evenodd" fill="url(#E-cl-0)"></circle><linearGradient x1="-1017.329" x2="-1018.602" y1="658.003" y2="657.998" gradientTransform="matrix(30 0 0 -1 30558 771)" gradientUnits="userSpaceOnUse" id="F-cl-0"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M30 113H0" stroke="url(#F-cl-0)"></path><linearGradient x1="-1014.501" x2="-1015.774" y1="839.985" y2="839.935" gradientTransform="matrix(26.5 0 0 -5.5 26925 4696.5)" gradientUnits="userSpaceOnUse" id="G-cl-0"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M33.5 79.5L7 74" stroke="url(#G-cl-0)"></path><linearGradient x1="-1016.59" x2="-1017.862" y1="852.671" y2="852.595" gradientTransform="matrix(29 0 0 -8 29523 6971)" gradientUnits="userSpaceOnUse" id="H-cl-0"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M34 146l-29 8" stroke="url(#H-cl-0)"></path><linearGradient x1="-1011.984" x2="-1013.257" y1="863.523" y2="863.229" gradientTransform="matrix(24 0 0 -13 24339 11407)" gradientUnits="userSpaceOnUse" id="I-cl-0"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M45 177l-24 13" stroke="url(#I-cl-0)"></path><linearGradient x1="-1006.673" x2="-1007.946" y1="869.279" y2="868.376" gradientTransform="matrix(20 0 0 -19 20205 16720)" gradientUnits="userSpaceOnUse" id="J-cl-0"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M67 204l-20 19" stroke="url(#J-cl-0)"></path><linearGradient x1="-992.85" x2="-993.317" y1="871.258" y2="870.258" gradientTransform="matrix(13.8339 0 0 -22.8467 13825.796 20131.938)" gradientUnits="userSpaceOnUse" id="K-cl-0"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M94.4 227l-13.8 22.8" stroke="url(#K-cl-0)"></path><linearGradient x1="-953.835" x2="-953.965" y1="871.9" y2="870.9" gradientTransform="matrix(7.5 0 0 -24.5 7278 21605)" gradientUnits="userSpaceOnUse" id="L-cl-0"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M127.5 243.5L120 268" stroke="url(#L-cl-0)"></path><linearGradient x1="244.504" x2="244.496" y1="871.898" y2="870.898" gradientTransform="matrix(.5 0 0 -24.5 45.5 21614)" gradientUnits="userSpaceOnUse" id="M-cl-0"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M167.5 252.5l.5 24.5" stroke="url(#M-cl-0)"></path></g></g></g></svg></div><div class="go3455555371"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 634 633" viewBox="0 0 634 633"><g transform="translate(1)"><linearGradient x1="-641.486" x2="-641.486" y1="856.648" y2="855.931" gradientTransform="matrix(633 0 0 -633 406377 542258)" gradientUnits="userSpaceOnUse" id="a-cl-1"><stop offset="0" stop-color="#6bdaff"></stop><stop offset="0.319" stop-color="#f9ffb5"></stop><stop offset="0.706" stop-color="#ffa770"></stop><stop offset="1" stop-color="#ff7373"></stop></linearGradient><circle cx="316.5" cy="316.5" r="316.5" fill-rule="evenodd" clip-rule="evenodd" fill="url(#a-cl-1)"></circle><defs><filter width="454" height="396.9" x="-137.5" y="412" filterUnits="userSpaceOnUse" id="b-cl-1"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="-137.5" y="412" maskUnits="userSpaceOnUse" id="c-cl-1"><g filter="url(#b-cl-1)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="89.5" cy="610.5" fill="#015064" fill-rule="evenodd" stroke="#00CFE2" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#c-cl-1)"></ellipse><defs><filter width="454" height="396.9" x="316.5" y="412" filterUnits="userSpaceOnUse" id="d-cl-1"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="316.5" y="412" maskUnits="userSpaceOnUse" id="e-cl-1"><g filter="url(#d-cl-1)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="543.5" cy="610.5" fill="#015064" fill-rule="evenodd" stroke="#00CFE2" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#e-cl-1)"></ellipse><defs><filter width="454" height="396.9" x="-137.5" y="450" filterUnits="userSpaceOnUse" id="f-cl-1"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="-137.5" y="450" maskUnits="userSpaceOnUse" id="g-cl-1"><g filter="url(#f-cl-1)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="89.5" cy="648.5" fill="#015064" fill-rule="evenodd" stroke="#00A8B8" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#g-cl-1)"></ellipse><defs><filter width="454" height="396.9" x="316.5" y="450" filterUnits="userSpaceOnUse" id="h-cl-1"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="316.5" y="450" maskUnits="userSpaceOnUse" id="i-cl-1"><g filter="url(#h-cl-1)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="543.5" cy="648.5" fill="#015064" fill-rule="evenodd" stroke="#00A8B8" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#i-cl-1)"></ellipse><defs><filter width="454" height="396.9" x="-137.5" y="486" filterUnits="userSpaceOnUse" id="j-cl-1"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="-137.5" y="486" maskUnits="userSpaceOnUse" id="k-cl-1"><g filter="url(#j-cl-1)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="89.5" cy="684.5" fill="#015064" fill-rule="evenodd" stroke="#007782" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#k-cl-1)"></ellipse><defs><filter width="454" height="396.9" x="316.5" y="486" filterUnits="userSpaceOnUse" id="l-cl-1"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="454" height="396.9" x="316.5" y="486" maskUnits="userSpaceOnUse" id="m-cl-1"><g filter="url(#l-cl-1)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><ellipse cx="543.5" cy="684.5" fill="#015064" fill-rule="evenodd" stroke="#007782" stroke-width="25" clip-rule="evenodd" rx="214.5" ry="186" mask="url(#m-cl-1)"></ellipse><defs><filter width="176.9" height="129.3" x="272.2" y="308" filterUnits="userSpaceOnUse" id="n-cl-1"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="176.9" height="129.3" x="272.2" y="308" maskUnits="userSpaceOnUse" id="o-cl-1"><g filter="url(#n-cl-1)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><g mask="url(#o-cl-1)"><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="11" d="M436 403.2l-5 28.6m-140-90.3l-10.9 62m52.8-19.4l-4.3 27.1"></path><linearGradient x1="-645.656" x2="-646.499" y1="854.878" y2="854.788" gradientTransform="matrix(-184.159 -32.4722 11.4608 -64.9973 -128419.844 34938.836)" gradientUnits="userSpaceOnUse" id="p-cl-1"><stop offset="0" stop-color="#ee2700"></stop><stop offset="1" stop-color="#ff008e"></stop></linearGradient><path fill-rule="evenodd" d="M344.1 363l97.7 17.2c5.8 2.1 8.2 6.2 7.1 12.1-1 5.9-4.7 9.2-11 9.9l-106-18.7-57.5-59.2c-3.2-4.8-2.9-9.1.8-12.8 3.7-3.7 8.3-4.4 13.7-2.1l55.2 53.6z" clip-rule="evenodd" fill="url(#p-cl-1)"></path><path fill="#D8D8D8" fill-rule="evenodd" stroke="#FFF" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="7" d="M428.3 384.5l.9-6.5m-33.9 1.5l.9-6.5m-34 .5l.9-6.1m-38.9-16.1l4.2-3.9m-25.2-16.1l4.2-3.9" clip-rule="evenodd"></path></g><defs><filter width="280.6" height="317.4" x="73.2" y="113.9" filterUnits="userSpaceOnUse" id="q-cl-1"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="280.6" height="317.4" x="73.2" y="113.9" maskUnits="userSpaceOnUse" id="r-cl-1"><g filter="url(#q-cl-1)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><g mask="url(#r-cl-1)"><linearGradient x1="-646.8" x2="-646.8" y1="854.844" y2="853.844" gradientTransform="matrix(-100.1751 48.8587 -97.9753 -200.879 19124.773 203538.61)" gradientUnits="userSpaceOnUse" id="s-cl-1"><stop offset="0" stop-color="#a17500"></stop><stop offset="1" stop-color="#5d2100"></stop></linearGradient><path fill-rule="evenodd" d="M192.3 203c8.1 37.3 14 73.6 17.8 109.1 3.8 35.4 2.8 75.2-2.9 119.2l61.2-16.7c-15.6-59-25.2-97.9-28.6-116.6-3.4-18.7-10.8-51.8-22.2-99.6l-25.3 4.6" clip-rule="evenodd" fill="url(#s-cl-1)"></path><linearGradient x1="-635.467" x2="-635.467" y1="852.115" y2="851.115" gradientTransform="matrix(92.6873 4.8575 2.0257 -38.6535 57323.695 36176.047)" gradientUnits="userSpaceOnUse" id="t-cl-1"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M195 183.9s-12.6-22.1-36.5-29.9c-15.9-5.2-34.4-1.5-55.5 11.1 15.9 14.3 29.5 22.6 40.7 24.9 16.8 3.6 51.3-6.1 51.3-6.1z" clip-rule="evenodd" fill="url(#t-cl-1)"></path><linearGradient x1="-636.573" x2="-636.573" y1="855.444" y2="854.444" gradientTransform="matrix(109.9945 5.7646 6.3597 -121.3507 64719.133 107659.336)" gradientUnits="userSpaceOnUse" id="u-cl-1"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M194.9 184.5s-47.5-8.5-83.2 15.7c-23.8 16.2-34.3 49.3-31.6 99.3 30.3-27.8 52.1-48.5 65.2-61.9 19.8-20 49.6-53.1 49.6-53.1z" clip-rule="evenodd" fill="url(#u-cl-1)"></path><linearGradient x1="-632.145" x2="-632.145" y1="854.174" y2="853.174" gradientTransform="matrix(62.9558 3.2994 3.5021 -66.8246 37035.367 59284.227)" gradientUnits="userSpaceOnUse" id="v-cl-1"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M195 183.9c-.8-21.9 6-38 20.6-48.2 14.6-10.2 29.8-15.3 45.5-15.3-6.1 21.4-14.5 35.8-25.2 43.4-10.7 7.5-24.4 14.2-40.9 20.1z" clip-rule="evenodd" fill="url(#v-cl-1)"></path><linearGradient x1="-638.224" x2="-638.224" y1="853.801" y2="852.801" gradientTransform="matrix(152.4666 7.9904 3.0934 -59.0251 94939.86 55646.855)" gradientUnits="userSpaceOnUse" id="w-cl-1"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M194.9 184.5c31.9-30 64.1-39.7 96.7-29 32.6 10.7 50.8 30.4 54.6 59.1-35.2-5.5-60.4-9.6-75.8-12.1-15.3-2.6-40.5-8.6-75.5-18z" clip-rule="evenodd" fill="url(#w-cl-1)"></path><linearGradient x1="-637.723" x2="-637.723" y1="855.103" y2="854.103" gradientTransform="matrix(136.467 7.1519 5.2165 -99.5377 82830.875 89859.578)" gradientUnits="userSpaceOnUse" id="x-cl-1"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M194.9 184.5c35.8-7.6 65.6-.2 89.2 22 23.6 22.2 37.7 49 42.3 80.3-39.8-9.7-68.3-23.8-85.5-42.4-17.2-18.5-32.5-38.5-46-59.9z" clip-rule="evenodd" fill="url(#x-cl-1)"></path><linearGradient x1="-631.79" x2="-631.79" y1="855.872" y2="854.872" gradientTransform="matrix(60.8683 3.19 8.7771 -167.4773 31110.818 145537.61)" gradientUnits="userSpaceOnUse" id="y-cl-1"><stop offset="0" stop-color="#2f8a00"></stop><stop offset="1" stop-color="#90ff57"></stop></linearGradient><path fill-rule="evenodd" stroke="#2F8A00" stroke-width="13" d="M194.9 184.5c-33.6 13.8-53.6 35.7-60.1 65.6-6.5 29.9-3.6 63.1 8.7 99.6 27.4-40.3 43.2-69.6 47.4-88 4.2-18.3 5.5-44.1 4-77.2z" clip-rule="evenodd" fill="url(#y-cl-1)"></path><path fill="none" stroke="#2F8A00" stroke-linecap="round" stroke-width="8" d="M196.5 182.3c-14.8 21.6-25.1 41.4-30.8 59.4-5.7 18-9.4 33-11.1 45.1"></path><path fill="none" stroke="#2F8A00" stroke-linecap="round" stroke-width="8" d="M194.8 185.7c-24.4 1.7-43.8 9-58.1 21.8-14.3 12.8-24.7 25.4-31.3 37.8m99.1-68.9c29.7-6.7 52-8.4 67-5 15 3.4 26.9 8.7 35.8 15.9m-110.8-5.9c20.3 9.9 38.2 20.5 53.9 31.9 15.7 11.4 27.4 22.1 35.1 32"></path></g><defs><filter width="532" height="633" x="50.5" y="399" filterUnits="userSpaceOnUse" id="z-cl-1"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="532" height="633" x="50.5" y="399" maskUnits="userSpaceOnUse" id="A-cl-1"><g filter="url(#z-cl-1)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><linearGradient x1="-641.104" x2="-641.278" y1="856.577" y2="856.183" gradientTransform="matrix(532 0 0 -633 341484.5 542657)" gradientUnits="userSpaceOnUse" id="B-cl-1"><stop offset="0" stop-color="#fff400"></stop><stop offset="1" stop-color="#3c8700"></stop></linearGradient><ellipse cx="316.5" cy="715.5" fill-rule="evenodd" clip-rule="evenodd" rx="266" ry="316.5" fill="url(#B-cl-1)" mask="url(#A-cl-1)"></ellipse><defs><filter width="288" height="283" x="391" y="-24" filterUnits="userSpaceOnUse" id="C-cl-1"><feColorMatrix values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"></feColorMatrix></filter></defs><mask width="288" height="283" x="391" y="-24" maskUnits="userSpaceOnUse" id="D-cl-1"><g filter="url(#C-cl-1)"><circle cx="316.5" cy="316.5" r="316.5" fill="#FFF" fill-rule="evenodd" clip-rule="evenodd"></circle></g></mask><g mask="url(#D-cl-1)"><g transform="translate(397 -24)"><linearGradient x1="-1036.672" x2="-1036.672" y1="880.018" y2="879.018" gradientTransform="matrix(227 0 0 -227 235493 199764)" gradientUnits="userSpaceOnUse" id="E-cl-1"><stop offset="0" stop-color="#ffdf00"></stop><stop offset="1" stop-color="#ff9d00"></stop></linearGradient><circle cx="168.5" cy="113.5" r="113.5" fill-rule="evenodd" clip-rule="evenodd" fill="url(#E-cl-1)"></circle><linearGradient x1="-1017.329" x2="-1018.602" y1="658.003" y2="657.998" gradientTransform="matrix(30 0 0 -1 30558 771)" gradientUnits="userSpaceOnUse" id="F-cl-1"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M30 113H0" stroke="url(#F-cl-1)"></path><linearGradient x1="-1014.501" x2="-1015.774" y1="839.985" y2="839.935" gradientTransform="matrix(26.5 0 0 -5.5 26925 4696.5)" gradientUnits="userSpaceOnUse" id="G-cl-1"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M33.5 79.5L7 74" stroke="url(#G-cl-1)"></path><linearGradient x1="-1016.59" x2="-1017.862" y1="852.671" y2="852.595" gradientTransform="matrix(29 0 0 -8 29523 6971)" gradientUnits="userSpaceOnUse" id="H-cl-1"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M34 146l-29 8" stroke="url(#H-cl-1)"></path><linearGradient x1="-1011.984" x2="-1013.257" y1="863.523" y2="863.229" gradientTransform="matrix(24 0 0 -13 24339 11407)" gradientUnits="userSpaceOnUse" id="I-cl-1"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M45 177l-24 13" stroke="url(#I-cl-1)"></path><linearGradient x1="-1006.673" x2="-1007.946" y1="869.279" y2="868.376" gradientTransform="matrix(20 0 0 -19 20205 16720)" gradientUnits="userSpaceOnUse" id="J-cl-1"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M67 204l-20 19" stroke="url(#J-cl-1)"></path><linearGradient x1="-992.85" x2="-993.317" y1="871.258" y2="870.258" gradientTransform="matrix(13.8339 0 0 -22.8467 13825.796 20131.938)" gradientUnits="userSpaceOnUse" id="K-cl-1"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M94.4 227l-13.8 22.8" stroke="url(#K-cl-1)"></path><linearGradient x1="-953.835" x2="-953.965" y1="871.9" y2="870.9" gradientTransform="matrix(7.5 0 0 -24.5 7278 21605)" gradientUnits="userSpaceOnUse" id="L-cl-1"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M127.5 243.5L120 268" stroke="url(#L-cl-1)"></path><linearGradient x1="244.504" x2="244.496" y1="871.898" y2="870.898" gradientTransform="matrix(.5 0 0 -24.5 45.5 21614)" gradientUnits="userSpaceOnUse" id="M-cl-1"><stop offset="0" stop-color="#ffa400"></stop><stop offset="1" stop-color="#ff5e00"></stop></linearGradient><path fill="none" stroke-linecap="round" stroke-linejoin="bevel" stroke-width="12" d="M167.5 252.5l.5 24.5" stroke="url(#M-cl-1)"></path></g></g></g></svg></div></div><div class="go2821754102">-</div><div class="go1561890071">TanStack Router</div></button></footer></div></main></main></div></div></div>
    <script type="module" src="/tidy-ts/src/main.tsx"></script>
  

</body></html>